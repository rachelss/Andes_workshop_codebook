<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Target capture data | Andes Phylogenomics Workshop</title>
  <meta name="description" content="Step-by-step guide to a project in phylogenomics." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Target capture data | Andes Phylogenomics Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Step-by-step guide to a project in phylogenomics." />
  <meta name="github-repo" content="rachelss/Andes_workshop_codebook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Target capture data | Andes Phylogenomics Workshop" />
  
  <meta name="twitter:description" content="Step-by-step guide to a project in phylogenomics." />
  

<meta name="author" content="Rachel Schwartz and Rosana Zenil-Ferguson" />


<meta name="date" content="2023-07-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tree-thinking-quiz.html"/>
<link rel="next" href="results.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Andes Phylogenomics Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this workshop</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#case-studies"><i class="fa fa-check"></i><b>2.2</b> Case Studies</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#course-objectives"><i class="fa fa-check"></i><b>2.3</b> Course Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-and-analysis.html"><a href="data-and-analysis.html"><i class="fa fa-check"></i><b>3</b> Data and analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-and-analysis.html"><a href="data-and-analysis.html#genomic-data"><i class="fa fa-check"></i><b>3.1</b> Genomic data</a></li>
<li class="chapter" data-level="3.2" data-path="data-and-analysis.html"><a href="data-and-analysis.html#phylogenies"><i class="fa fa-check"></i><b>3.2</b> Phylogenies</a></li>
<li class="chapter" data-level="3.3" data-path="data-and-analysis.html"><a href="data-and-analysis.html#comparative-analyses"><i class="fa fa-check"></i><b>3.3</b> Comparative analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="trait-data.html"><a href="trait-data.html"><i class="fa fa-check"></i><b>4</b> Trait Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="trait-data.html"><a href="trait-data.html#getting-started-with-r"><i class="fa fa-check"></i><b>4.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="trait-data.html"><a href="trait-data.html#option-1-log-in-to-the-server"><i class="fa fa-check"></i><b>4.1.1</b> Option 1: Log in to the server</a></li>
<li class="chapter" data-level="4.1.2" data-path="trait-data.html"><a href="trait-data.html#option-2-work-on-your-personal-computer"><i class="fa fa-check"></i><b>4.1.2</b> Option 2: Work on your personal computer</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="trait-data.html"><a href="trait-data.html#load-and-set-up-data"><i class="fa fa-check"></i><b>4.2</b> Load and set up data</a></li>
<li class="chapter" data-level="4.3" data-path="trait-data.html"><a href="trait-data.html#beginning-an-analysis"><i class="fa fa-check"></i><b>4.3</b> Beginning an analysis</a></li>
<li class="chapter" data-level="4.4" data-path="trait-data.html"><a href="trait-data.html#data-visualization"><i class="fa fa-check"></i><b>4.4</b> Data Visualization</a></li>
<li class="chapter" data-level="4.5" data-path="trait-data.html"><a href="trait-data.html#statistical-tests-of-relationships"><i class="fa fa-check"></i><b>4.5</b> Statistical tests of relationships</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="computational-skills.html"><a href="computational-skills.html"><i class="fa fa-check"></i><b>5</b> Computational skills</a>
<ul>
<li class="chapter" data-level="5.1" data-path="computational-skills.html"><a href="computational-skills.html#basic-navigation"><i class="fa fa-check"></i><b>5.1</b> Basic navigation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="getting-your-data.html"><a href="getting-your-data.html"><i class="fa fa-check"></i><b>6</b> Getting your data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-your-data.html"><a href="getting-your-data.html#repeating-analyses"><i class="fa fa-check"></i><b>6.1</b> Repeating analyses</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tree-thinking-quiz.html"><a href="tree-thinking-quiz.html"><i class="fa fa-check"></i><b>7</b> Tree thinking quiz</a></li>
<li class="chapter" data-level="8" data-path="target-capture-data.html"><a href="target-capture-data.html"><i class="fa fa-check"></i><b>8</b> Target capture data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="target-capture-data.html"><a href="target-capture-data.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="target-capture-data.html"><a href="target-capture-data.html#running-hybpiper-to-assemble-genes"><i class="fa fa-check"></i><b>8.2</b> Running HybPiper to assemble genes</a></li>
<li class="chapter" data-level="8.3" data-path="target-capture-data.html"><a href="target-capture-data.html#hybpiper-outputs"><i class="fa fa-check"></i><b>8.3</b> Hybpiper outputs</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="target-capture-data.html"><a href="target-capture-data.html#viewing-information"><i class="fa fa-check"></i><b>8.3.1</b> Viewing information</a></li>
<li class="chapter" data-level="8.3.2" data-path="target-capture-data.html"><a href="target-capture-data.html#obtain-gene-data"><i class="fa fa-check"></i><b>8.3.2</b> Obtain gene data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="target-capture-data.html"><a href="target-capture-data.html#visual-inspection-of-data"><i class="fa fa-check"></i><b>8.4</b> Visual inspection of data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>9</b> Results</a>
<ul>
<li class="chapter" data-level="9.1" data-path="results.html"><a href="results.html#alignment"><i class="fa fa-check"></i><b>9.1</b> Alignment</a></li>
<li class="chapter" data-level="9.2" data-path="results.html"><a href="results.html#view-in-r"><i class="fa fa-check"></i><b>9.2</b> View in R</a></li>
<li class="chapter" data-level="9.3" data-path="results.html"><a href="results.html#concatenated-data-analysis"><i class="fa fa-check"></i><b>9.3</b> Concatenated data analysis</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="results.html"><a href="results.html#building-trees-with-iqtree"><i class="fa fa-check"></i><b>9.3.1</b> Building trees with IQTree</a></li>
<li class="chapter" data-level="9.3.2" data-path="results.html"><a href="results.html#viewing-trees"><i class="fa fa-check"></i><b>9.3.2</b> Viewing trees</a></li>
<li class="chapter" data-level="9.3.3" data-path="results.html"><a href="results.html#tree-for-all-data-using-output-of-individual-hybpiper-runs"><i class="fa fa-check"></i><b>9.3.3</b> Tree for all data using output of individual hybpiper runs</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="results.html"><a href="results.html#species-tree-analyses"><i class="fa fa-check"></i><b>9.4</b> Species tree analyses</a></li>
<li class="chapter" data-level="9.5" data-path="results.html"><a href="results.html#support-for-relationships"><i class="fa fa-check"></i><b>9.5</b> Support for relationships</a></li>
<li class="chapter" data-level="9.6" data-path="results.html"><a href="results.html#mrbayes"><i class="fa fa-check"></i><b>9.6</b> MrBayes</a></li>
<li class="chapter" data-level="9.7" data-path="results.html"><a href="results.html#what-do-your-trees-tell-you"><i class="fa fa-check"></i><b>9.7</b> What do your trees tell you?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dates-and-evolution.html"><a href="dates-and-evolution.html"><i class="fa fa-check"></i><b>10</b> Dates and Evolution</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dates-and-evolution.html"><a href="dates-and-evolution.html#dates-times-on-trees"><i class="fa fa-check"></i><b>10.1</b> Dates / Times on Trees</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html"><i class="fa fa-check"></i><b>11</b> Understanding the likelihood function</a>
<ul>
<li class="chapter" data-level="11.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#background-1"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-model"><i class="fa fa-check"></i><b>11.2</b> The model</a></li>
<li class="chapter" data-level="11.3" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-likelihood-function"><i class="fa fa-check"></i><b>11.3</b> The likelihood function</a></li>
<li class="chapter" data-level="11.4" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#a-mini-example-with-a-sample-size-of-two"><i class="fa fa-check"></i><b>11.4</b> A mini example with a sample size of two</a></li>
<li class="chapter" data-level="11.5" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-bird-alarm-example"><i class="fa fa-check"></i><b>11.5</b> The bird alarm example</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#calculate-the-mle-for-dl-and-f-and-the-likelihood-value-evaluated-at-the-mle"><i class="fa fa-check"></i><b>11.5.1</b> Calculate the MLE for DL and F and the likelihood value evaluated at the MLE</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#where-is-the-evidence-for-different-behavior"><i class="fa fa-check"></i><b>11.6</b> Where is the evidence for different behavior?</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#plot-the-likelihood-for-dead-leaf-gleaners"><i class="fa fa-check"></i><b>11.6.1</b> Plot the likelihood for dead-leaf gleaners</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#are-the-freezing-times-different-for-the-two-groups"><i class="fa fa-check"></i><b>11.7</b> Are the freezing times different for the two groups?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html"><i class="fa fa-check"></i><b>12</b> What is Bayesian statistics?</a>
<ul>
<li class="chapter" data-level="12.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#what-about-all-the-fighting-of-frequentists-vs.-bayesians"><i class="fa fa-check"></i><b>12.1</b> What about all the fighting of “frequentists” vs. “Bayesians”</a></li>
<li class="chapter" data-level="12.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#when-do-we-choose-bayesian-statistics"><i class="fa fa-check"></i><b>12.2</b> When do we choose Bayesian statistics?</a></li>
<li class="chapter" data-level="12.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#basic-concepts-of-bayesian-statistics"><i class="fa fa-check"></i><b>12.3</b> Basic concepts of Bayesian Statistics</a></li>
<li class="chapter" data-level="12.4" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#example-online-dating"><i class="fa fa-check"></i><b>12.4</b> Example: Online dating</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#pab-is-difficult-to-estimate"><i class="fa fa-check"></i><b>12.4.1</b> <span class="math inline">\(P(A|B)\)</span> is difficult to estimate</a></li>
<li class="chapter" data-level="12.4.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#coming-back-to-the-initial-idea-of-how-we-define-bayesian-statistics"><i class="fa fa-check"></i><b>12.4.2</b> Coming back to the initial idea of how we define Bayesian statistics</a></li>
<li class="chapter" data-level="12.4.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-random-variable"><i class="fa fa-check"></i><b>12.4.3</b> The random variable</a></li>
<li class="chapter" data-level="12.4.4" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-prior-distribution"><i class="fa fa-check"></i><b>12.4.4</b> The prior distribution</a></li>
<li class="chapter" data-level="12.4.5" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-data-and-their-distribution"><i class="fa fa-check"></i><b>12.4.5</b> The Data and their distribution</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-likelihood-function-1"><i class="fa fa-check"></i><b>12.5</b> The likelihood function</a></li>
<li class="chapter" data-level="12.6" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-update-the-posterior-distribution"><i class="fa fa-check"></i><b>12.6</b> The update! The posterior distribution</a></li>
<li class="chapter" data-level="12.7" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#optional-section-doing-your-first-mcmc"><i class="fa fa-check"></i><b>12.7</b> Optional section: Doing your first MCMC</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-proposal-function"><i class="fa fa-check"></i><b>12.7.1</b> The proposal function</a></li>
<li class="chapter" data-level="12.7.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-metropolis-hastings"><i class="fa fa-check"></i><b>12.7.2</b> The Metropolis-Hastings</a></li>
<li class="chapter" data-level="12.7.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#visualizing-the-mcmc-as-a-way-to-find-out-convergence"><i class="fa fa-check"></i><b>12.7.3</b> Visualizing the MCMC as a way to find out convergence</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#changing-the-proposal"><i class="fa fa-check"></i><b>12.8</b> Changing the proposal</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html"><i class="fa fa-check"></i><b>13</b> Introduction to macroevolution modeling</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#reading-dataset-and-phylogenetic-tree"><i class="fa fa-check"></i><b>13.1</b> Reading dataset and phylogenetic tree</a></li>
<li class="chapter" data-level="13.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-a-phylogenetic-tree-with-data"><i class="fa fa-check"></i><b>13.2</b> Plotting a phylogenetic tree with data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-continuous-data"><i class="fa fa-check"></i><b>13.2.1</b> Plotting continuous data</a></li>
<li class="chapter" data-level="13.2.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-discrete-and-continuous-data"><i class="fa fa-check"></i><b>13.2.2</b> Plotting discrete and continuous data</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#introduction-to-brownian-motion"><i class="fa fa-check"></i><b>13.3</b> Introduction to Brownian Motion</a></li>
<li class="chapter" data-level="13.4" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#brownian-motion-in-phylogenetic-comparative-methods"><i class="fa fa-check"></i><b>13.4</b> Brownian motion in phylogenetic comparative methods</a></li>
<li class="chapter" data-level="13.5" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#shared-ancestry-and-continuous-character-evolution"><i class="fa fa-check"></i><b>13.5</b> Shared ancestry and continuous character evolution</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#always-visualize-your-data"><i class="fa fa-check"></i><b>13.5.1</b> Always visualize your data</a></li>
<li class="chapter" data-level="13.5.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#fitting-bm-on-flower-length"><i class="fa fa-check"></i><b>13.5.2</b> Fitting BM on flower length</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html"><i class="fa fa-check"></i><b>14</b> Phylogenetic Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#phylogenetic-linear-models"><i class="fa fa-check"></i><b>14.1</b> Phylogenetic Linear Models</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>14.1.1</b> Testing the hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#what-happens-if-the-model-of-evolution-is-not-brownian-motion-but-something-else"><i class="fa fa-check"></i><b>14.2</b> What happens if the model of evolution is not Brownian motion but something else?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html"><i class="fa fa-check"></i><b>15</b> Discrete variable modeling</a>
<ul>
<li class="chapter" data-level="15.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#plotting-discrete-data-on-a-phylogeny"><i class="fa fa-check"></i><b>15.1</b> Plotting discrete data on a phylogeny</a></li>
<li class="chapter" data-level="15.2" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#discrete-character-evolution"><i class="fa fa-check"></i><b>15.2</b> Discrete character evolution</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#what-is-a-q-matrix"><i class="fa fa-check"></i><b>15.2.1</b> What is a Q-matrix?</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#modeling-using-ctmcs"><i class="fa fa-check"></i><b>15.3</b> Modeling using CTMCs</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#modeling-the-transition-rates-between-two-states"><i class="fa fa-check"></i><b>15.3.1</b> Modeling the transition rates between two states</a></li>
<li class="chapter" data-level="15.3.2" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#model-comparison"><i class="fa fa-check"></i><b>15.3.2</b> Model comparison</a></li>
<li class="chapter" data-level="15.3.3" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#stochastic-mapping"><i class="fa fa-check"></i><b>15.3.3</b> Stochastic mapping</a></li>
<li class="chapter" data-level="15.3.4" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#modeling-hidden-states"><i class="fa fa-check"></i><b>15.3.4</b> Modeling hidden states</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="continuing-on-your-own.html"><a href="continuing-on-your-own.html"><i class="fa fa-check"></i><b>16</b> Continuing on your own</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Andes Phylogenomics Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="target-capture-data" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Target capture data<a href="target-capture-data.html#target-capture-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="background" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Background<a href="target-capture-data.html#background" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Much of the information in this chapter is drawn from the HybPiper tutorial, which can be found at <a href="https://github.com/mossmatters/HybPiper/wiki/Tutorial" class="uri">https://github.com/mossmatters/HybPiper/wiki/Tutorial</a></p>
<p>First make a folder in your home directory to hold your outputs for this component of the project.</p>
<p>We have pre-installed the program HybPiper on the server, which assembles target sequences from short high-throughput DNA sequencing reads.
By assembling each target sequence for each species we will be able to produce a dataset that allows us to understand the evolutionary history of the species.</p>
<p>To access HybPiper run</p>
<pre><code>conda activate /mnt/homes4celsrs/shared/envs/hybpiper</code></pre>
<p>This activates a conda environment (don’t worry about this!).</p>
<p><strong>If you need to obtain Hybpiper on your personal computer:</strong></p>
<ul>
<li>Download Miniconda for <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/windows.html">Windows</a> or <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/install/macos.html">Mac</a> and install following the instructions</li>
<li>Follow the instructions for bioconda and hybpiper installation: <a href="https://github.com/mossmatters/HybPiper/wiki/Installation" class="uri">https://github.com/mossmatters/HybPiper/wiki/Installation</a></li>
<li>Use the data you downloaded previously</li>
</ul>
<p>In this case, our target sequences are either the Angiosperm 353 standard targets
or a set of target data designed specifically for these taxa.
One goal of this workshop is to compare the results from different target sets.
Target capture is a standard technique for sequencing many known loci simultaneously using a library of sequences.
We have provided you with low-coverage sequence data from using these target sequences as probes (your fastq files).
HybPiper first assigns each read to a particular target using alignment software (BWA).
These reads are then assembled using a standard genome assembler (Spades).
HybPiper outputs a fasta file of the (in frame) CDS portion of each sample for each target region.</p>
</div>
<div id="running-hybpiper-to-assemble-genes" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Running HybPiper to assemble genes<a href="target-capture-data.html#running-hybpiper-to-assemble-genes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The basic command for HybPiper is as follows:</p>
<pre><code>hybpiper assemble -t_dna targets.fasta -r species1_R*_test.fastq --prefix species1 --bwa --cpu 3</code></pre>
<p>Notice the commands and flags.
Move to the results directory in your workshop directory to run the following commands.
You should run this command, with the following changes:</p>
<ul>
<li>The argument for the t_dna flag is the relevant fasta target file in the shared workshop folder for your dataset - you will need to indicate a full relative path not just the file name (e.g. ../../shared/AndesWorkshop2023/Campanulaceae_353.fasta). If you are using SISRS data your target file is specific to your taxon set; if you are using 353 data use the Campanulaceae file. If you are working on your personal computer download <a href="https://raw.githubusercontent.com/rachelss/Andes_workshop_codebook/main/SISRS_targets_TaxonSet5.fa">this target file</a> and use the correct path to the file.</li>
<li>The argument for the the r flag is the filename(s) including paths for the fastq files of interest. Note the * indicates that we will use both pairs of the sequencing read files. Because you do not have a file named species1 you will need to change this name.</li>
<li>The prefix should be indicative of the species name</li>
<li>Note that we are sharing a server so we are specifying 3 cpu’s per group. If you are running on your own machine you can omit this flag and HybPiper will use all available resources. With limited shared resources this run may take a few minutes.</li>
</ul>
<p>To view your results, list the contents of the folder and folders inside this.
You should see a folder for each gene.
Within each folder you can see several fasta files, which you can view.</p>
<p>To automatically run all samples consecutively you will need to loop through them.
Go back and look at the prior example of loops.
One approach is to make a list of all the names of the species in a file and then read that and use them one at a time.</p>
<p>First we need to make the list. We want to automate this process because in some cases you could have a lot of samples. Additionally, copying and pasting names into a list is prone to error.
Additionally, once you automate this process you could repeat it easily and quickly for other datasets.
For starters make a list of just the R1 files (you don’t want R2 files because they have the same name so you would have duplicates).
First <code>cd</code> back to your data folder.
Output your list to a file in your results folder named <code>namelist.txt</code> by “redirecting” the output using <code>&gt;</code>.</p>
<pre><code>ls *R1* &gt; ~/evolution_workshop/results/namelist.txt </code></pre>
<p>Check that this worked using <code>cat</code> or by viewing the file and counting the number of lines.
We will need to adjust this output to remove the R1 label so that we can use wildcards to list both files together.
One approach is to notice a pattern in filenames: the files start with a sample identifier followed by an underscore followed by another identifier.
Thus, we can “cut off” all of the name after the second underscore and still have a unique name for our sample.
We use the “cut” command to make our data into columns using _ (specify a delimiter with -d), then we select the first two of these (use the field flag -f).</p>
<pre><code>ls *R1* | cut -d &#39;_&#39; -f 1,2 &gt; ~/evolution_workshop/results/namelist.txt </code></pre>
<p><strong>Note that if you are on your personal computer your output path will be different</strong></p>
<p>Check this worked.
Now we can run HybPiper on all of our data sequentially.
In the following example, the species names are entered in the namelist.txt file.
The loop will iterate through them one at a time and run HybPiper.</p>
<pre><code>while read name
do 
    [insert command here]
done &lt; [path to]/namelist.txt</code></pre>
<p>This <code>while</code> loop looks a lot like the <code>for</code> loop we saw previously,
except that now we are reading in the file (it’s at the end for the command) and going through it line by line.
<code>name</code> here is the variable you will use. In other cases I might start off with <code>while read line</code>. The <code>while</code> and <code>read</code> are commands but <code>name</code> or <code>line</code> is the information read in from the file that you use in the command (don’t forget to use <code>$name</code> or <code>$line</code> in your command).</p>
<p>Make sure your command is reading the correct files each time through the loop. It is helpful to put <code>echo</code> in front of your command to print rather than run the command to check that it works.</p>
<p>This analysis will take a couple of hours. Check with an instructor before running this command to ensure you have done everything correctly.
Additionally, if you are on the server it’s advisable to run this command in the background.
That means the command will run but you will continue to have access to your prompt so you can work.
Additionally you can log out of the server (eg for lunch) and the command will continue to run.
To run the command in background enclose the entire command (from before while to after txt) in <code>( )</code>
and then add <code>&amp;&gt; output.log &amp;</code> at the end to write the information that would normally print to the screen (as you saw when running a single command) to the file <code>output.log</code>.
You can view this file (<code>less</code> or <code>tail</code>) to watch the progress of your command.
The following is an example to see how running in background works.
Assume you want to run the following example command (if you try this you need to create <code>examplefile.txt</code> first or use another short file).</p>
<pre><code>while read line
do
  echo $line
  sleep 5
done &lt; examplefile.txt </code></pre>
<p>You can run this command in background as</p>
<pre><code>(while read line
do
  echo $line
  sleep 5
done &lt; examplefile.txt ) &amp;&gt; output.log &amp;</code></pre>
<p>If you <code>cat output.log</code> you will see information being printed to this file (rather than to the screen as was done when not running in background). The <code>&amp;</code> runs the command in background while the <code>&amp;&gt;</code> sends what would have been printed to the screen to the designated file.</p>
</div>
<div id="hybpiper-outputs" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Hybpiper outputs<a href="target-capture-data.html#hybpiper-outputs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To obtain some information about the results of your HybPiper run use the <code>hybpiper stats</code> command as follows.</p>
<pre><code>hybpiper stats -t_dna [target file] gene [path to]/namelist.txt</code></pre>
<p>Hybpiper stats will generate two files: <code>seq_lengths.tsv</code> and <code>hybpiper_stats.tsv</code>.
The first line of seq_lengths.tsv has the names of each gene.
The second line has the length of the target gene, averaged over each “source” for that gene.
The rest of the lines are the length of the sequence recovered by HybPiper for each gene. If there was no sequence for a gene, a 0 is entered.</p>
<div id="viewing-information" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Viewing information<a href="target-capture-data.html#viewing-information" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While you can <code>cat</code> or <code>head</code> this file it is difficult to view this information on the command line.
However, R is excellent for reading data in this format.</p>
<ul>
<li>Select File - New File - R script</li>
<li>Save this file in the scripts folder</li>
<li>Load the tidyverse library</li>
</ul>
<p>We will use the <code>read.table</code> command because our data are plain text separated by tabs (not commas as for csv files).
We have three arguments: the filename (including path), how the columns are separated, and whether the file has a header line.</p>
<p>Note: R assumes you are in your project folder so all paths should be relative to this.</p>
<pre><code>stats &lt;- read.table(&quot;results/hybpiper_stats.tsv&quot;, sep = &quot;\t&quot;, header = TRUE)</code></pre>
<p>View your stats data.</p>
<p>Read and view <code>seq_lengths.tsv</code>.</p>
<p>Given your observation of the output tables, you may be interested in some of the following questions:</p>
<ul>
<li>What are the min, max, and average number of genes retrieved across samples?</li>
<li>What is the range of lengths retrieved for a given gene?</li>
</ul>
<p>You should take a look at the data and imagine how you would calculate this.
Unfortunately,this process (e.g. calculating the min value of each column individually) could be challenging to communicate to the computer effectively.
Furthermore, when we look at data in this “rectangular” form, we often want to ensure that our
data are “tidy”.
Tidy data usually has one sample per row.
Currently our data have many observations per gene per row.
If we were to look at the lengths file and make a new row that includes our
calculation of the standard deviation of the gene lengths this would be a row with summary
information not sample information.</p>
<p>Instead of working with these data frames directly we are going to take a look at an example
that I have made for you that includes stats for just two samples in “long form.”</p>
<ul>
<li>Read the file <code>stats_example.csv</code> in the shared workshop folder using the <code>read_csv</code> command.</li>
<li>Take a look at how these data are organized. Can you see how the data are organized that each row contains one piece of information?</li>
<li>Plot <code>value</code> v. <code>stat</code> as a scatter plot.</li>
</ul>
<p>We can add a couple of tweaks to make our view better. First we can specify that we want each sample to be a different color by including a <code>color = Name</code> argument in our <code>aes</code>. Second we can rotate the graph 90 degrees to better view the data and labels by adding a layer <code>coord_flip()</code>.</p>
<p>Now that you can see this example data better you can see it is trivial with only two samples with low information. However, you can imagine that we would like to have our real data in this format.</p>
<p>In order to work with <em>your</em> stats table you need to know how to produce a long format table.
This is tricky and will take some practice so don’t worry if it seems complicated initially.
We will use the <code>pivot_longer</code> function.
If you haven’t noticed already, when you type a function and hit the tab button on your keyboard you will see a list of arguments.
The first argument you need is the data.
The second argument is the list of columns that will not be in the long table and currently contain the observation data.
For us this is all the columns from NumReads to GenesWithChimeraWarning.
Now we need to envision our new table. Go back and look at the example table for some help here.
I specified a table with a column to indicate the particular stat we are measuring and
a second column for the actual value observed.
This command, with these four arguments looks like the following:</p>
<pre><code>stats_long &lt;- pivot_longer(stats, cols = NumReads:GenesWithChimeraWarning, names_to = &#39;stat&#39;, values_to = &#39;value&#39;)</code></pre>
<p>We can also generate a summary table with one row per stat and information in that row including the mean, standard deviation, etc. across genes.</p>
<p>The first component of this is to develop groups of rows by stat.
I like to imagine this as drawing boxes around all rows that contain a particular stat.
We use the <code>group_by</code> function to communicate to the computer these “boxes”.</p>
<pre><code>group_by(stats_long, stat)</code></pre>
<p>If you run this command the data won’t appear to be any different.
Now we need to generate a summary table where each group is collapsed into a single row in our new table containing the stat, its average, and standard deviation.</p>
<pre><code>mean_stats &lt;- group_by(stats_long, stat) %&gt;% summarize(mean_across_species = mean(value),
                                                       sd = sd(value))</code></pre>
<p>Note that here we use <code>%&gt;%</code> as the pipe command to send the output of one command to the next.
You have send the shell pipe <code>|</code> and this works the same way. In our summarize command we provide
new column labels and what the contents of these columns will be.</p>
<p>Click on your <code>mean_stats</code> variable to view your summary table.</p>
<p>Now try to work with the lengths table. First make a long format table. You want to output a table with the columns Species, gene, and length.</p>
<p>Did you notice that the mean lengths are already included in this table? That’s really useful but also these data are not information about each sample and if we want to make summary tables and graphs we don’t want to include them.</p>
<p>We can use the <code>filter</code> command to only include data that does not (<code>!=</code> is not equal to) specify MeanLength in the Species column.</p>
<pre><code>lengths_long_filtered &lt;- filter(lengths_long, Species != &quot;MeanLength&quot;)</code></pre>
<p>Now can you filter this output to include only data where the value in the length column is greater than 0.</p>
<p>Now you should be able to make a summary table including the the mean length per gene, standard deviation of length per gene, and count of genes. Note that we did our second filtering step so these values would be accurate. Additionally, the counting function is <code>n()</code> (no arguments required).</p>
<p>Save your script!</p>
</div>
<div id="obtain-gene-data" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Obtain gene data<a href="target-capture-data.html#obtain-gene-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At this point, we will go back to our Terminal.
Remind yourself of your folders and data and note each sequence is in its own folder.
We can use HybPiper to fetch the sequences recovered for the same gene from multiple samples and generate a file for each gene. Use the following command:</p>
<pre><code>hybpiper retrieve_sequences dna -t_dna [target file]  --sample_names [path to]/namelist.txt</code></pre>
<p>You should now see one file per gene in your results folder.
Each file is fasta formatted with the data for each available species.
In the next section we will create an alignment of all species for each gene.</p>
<p>Note that HybPiper has additional features we will not use in this workshop due to a lack of time.</p>
</div>
</div>
<div id="visual-inspection-of-data" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Visual inspection of data<a href="target-capture-data.html#visual-inspection-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To check that your genes assembled correctly and are likely the correct species you may use BLAST, which is found at <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi" class="uri">https://blast.ncbi.nlm.nih.gov/Blast.cgi</a></p>
<ul>
<li>Select Nucleotide BLAST</li>
<li>Paste one of the contigs from one of the genes from one of the species</li>
<li>Select Somewhat similar sequences (blastn)</li>
<li>BLAST</li>
<li>Examine the species and the match</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tree-thinking-quiz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="results.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-hybpiper.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
