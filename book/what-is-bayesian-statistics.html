<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 What is Bayesian statistics? | Andes Phylogenomics Workshop</title>
  <meta name="description" content="Step-by-step guide to a project in phylogenomics." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 What is Bayesian statistics? | Andes Phylogenomics Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Step-by-step guide to a project in phylogenomics." />
  <meta name="github-repo" content="rachelss/Andes_workshop_codebook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 What is Bayesian statistics? | Andes Phylogenomics Workshop" />
  
  <meta name="twitter:description" content="Step-by-step guide to a project in phylogenomics." />
  

<meta name="author" content="Rachel Schwartz and Rosana Zenil-Ferguson" />


<meta name="date" content="2023-07-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="understanding-the-likelihood-function.html"/>
<link rel="next" href="introduction-to-macroevolution-modeling.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Andes Phylogenomics Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this workshop</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#case-studies"><i class="fa fa-check"></i><b>2.2</b> Case Studies</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#course-objectives"><i class="fa fa-check"></i><b>2.3</b> Course Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-and-analysis.html"><a href="data-and-analysis.html"><i class="fa fa-check"></i><b>3</b> Data and analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-and-analysis.html"><a href="data-and-analysis.html#genomic-data"><i class="fa fa-check"></i><b>3.1</b> Genomic data</a></li>
<li class="chapter" data-level="3.2" data-path="data-and-analysis.html"><a href="data-and-analysis.html#phylogenies"><i class="fa fa-check"></i><b>3.2</b> Phylogenies</a></li>
<li class="chapter" data-level="3.3" data-path="data-and-analysis.html"><a href="data-and-analysis.html#comparative-analyses"><i class="fa fa-check"></i><b>3.3</b> Comparative analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="trait-data.html"><a href="trait-data.html"><i class="fa fa-check"></i><b>4</b> Trait Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="trait-data.html"><a href="trait-data.html#getting-started-with-r"><i class="fa fa-check"></i><b>4.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="trait-data.html"><a href="trait-data.html#option-1-log-in-to-the-server"><i class="fa fa-check"></i><b>4.1.1</b> Option 1: Log in to the server</a></li>
<li class="chapter" data-level="4.1.2" data-path="trait-data.html"><a href="trait-data.html#option-2-work-on-your-personal-computer"><i class="fa fa-check"></i><b>4.1.2</b> Option 2: Work on your personal computer</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="trait-data.html"><a href="trait-data.html#load-and-set-up-data"><i class="fa fa-check"></i><b>4.2</b> Load and set up data</a></li>
<li class="chapter" data-level="4.3" data-path="trait-data.html"><a href="trait-data.html#beginning-an-analysis"><i class="fa fa-check"></i><b>4.3</b> Beginning an analysis</a></li>
<li class="chapter" data-level="4.4" data-path="trait-data.html"><a href="trait-data.html#data-visualization"><i class="fa fa-check"></i><b>4.4</b> Data Visualization</a></li>
<li class="chapter" data-level="4.5" data-path="trait-data.html"><a href="trait-data.html#statistical-tests-of-relationships"><i class="fa fa-check"></i><b>4.5</b> Statistical tests of relationships</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="computational-skills.html"><a href="computational-skills.html"><i class="fa fa-check"></i><b>5</b> Computational skills</a>
<ul>
<li class="chapter" data-level="5.1" data-path="computational-skills.html"><a href="computational-skills.html#basic-navigation"><i class="fa fa-check"></i><b>5.1</b> Basic navigation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="getting-your-data.html"><a href="getting-your-data.html"><i class="fa fa-check"></i><b>6</b> Getting your data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-your-data.html"><a href="getting-your-data.html#repeating-analyses"><i class="fa fa-check"></i><b>6.1</b> Repeating analyses</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tree-thinking-quiz.html"><a href="tree-thinking-quiz.html"><i class="fa fa-check"></i><b>7</b> Tree thinking quiz</a></li>
<li class="chapter" data-level="8" data-path="target-capture-data.html"><a href="target-capture-data.html"><i class="fa fa-check"></i><b>8</b> Target capture data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="target-capture-data.html"><a href="target-capture-data.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="target-capture-data.html"><a href="target-capture-data.html#running-hybpiper-to-assemble-genes"><i class="fa fa-check"></i><b>8.2</b> Running HybPiper to assemble genes</a></li>
<li class="chapter" data-level="8.3" data-path="target-capture-data.html"><a href="target-capture-data.html#hybpiper-outputs"><i class="fa fa-check"></i><b>8.3</b> Hybpiper outputs</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="target-capture-data.html"><a href="target-capture-data.html#viewing-information"><i class="fa fa-check"></i><b>8.3.1</b> Viewing information</a></li>
<li class="chapter" data-level="8.3.2" data-path="target-capture-data.html"><a href="target-capture-data.html#obtain-gene-data"><i class="fa fa-check"></i><b>8.3.2</b> Obtain gene data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="target-capture-data.html"><a href="target-capture-data.html#visual-inspection-of-data"><i class="fa fa-check"></i><b>8.4</b> Visual inspection of data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>9</b> Results</a>
<ul>
<li class="chapter" data-level="9.1" data-path="results.html"><a href="results.html#alignment"><i class="fa fa-check"></i><b>9.1</b> Alignment</a></li>
<li class="chapter" data-level="9.2" data-path="results.html"><a href="results.html#view-in-r"><i class="fa fa-check"></i><b>9.2</b> View in R</a></li>
<li class="chapter" data-level="9.3" data-path="results.html"><a href="results.html#concatenated-data-analysis"><i class="fa fa-check"></i><b>9.3</b> Concatenated data analysis</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="results.html"><a href="results.html#building-trees-with-iqtree"><i class="fa fa-check"></i><b>9.3.1</b> Building trees with IQTree</a></li>
<li class="chapter" data-level="9.3.2" data-path="results.html"><a href="results.html#viewing-trees"><i class="fa fa-check"></i><b>9.3.2</b> Viewing trees</a></li>
<li class="chapter" data-level="9.3.3" data-path="results.html"><a href="results.html#tree-for-all-data-using-output-of-individual-hybpiper-runs"><i class="fa fa-check"></i><b>9.3.3</b> Tree for all data using output of individual hybpiper runs</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="results.html"><a href="results.html#species-tree-analyses"><i class="fa fa-check"></i><b>9.4</b> Species tree analyses</a></li>
<li class="chapter" data-level="9.5" data-path="results.html"><a href="results.html#support-for-relationships"><i class="fa fa-check"></i><b>9.5</b> Support for relationships</a></li>
<li class="chapter" data-level="9.6" data-path="results.html"><a href="results.html#mrbayes"><i class="fa fa-check"></i><b>9.6</b> MrBayes</a></li>
<li class="chapter" data-level="9.7" data-path="results.html"><a href="results.html#what-do-your-trees-tell-you"><i class="fa fa-check"></i><b>9.7</b> What do your trees tell you?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dates-and-evolution.html"><a href="dates-and-evolution.html"><i class="fa fa-check"></i><b>10</b> Dates and Evolution</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dates-and-evolution.html"><a href="dates-and-evolution.html#dates-times-on-trees"><i class="fa fa-check"></i><b>10.1</b> Dates / Times on Trees</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html"><i class="fa fa-check"></i><b>11</b> Understanding the likelihood function</a>
<ul>
<li class="chapter" data-level="11.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#background-1"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-model"><i class="fa fa-check"></i><b>11.2</b> The model</a></li>
<li class="chapter" data-level="11.3" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-likelihood-function"><i class="fa fa-check"></i><b>11.3</b> The likelihood function</a></li>
<li class="chapter" data-level="11.4" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#a-mini-example-with-a-sample-size-of-two"><i class="fa fa-check"></i><b>11.4</b> A mini example with a sample size of two</a></li>
<li class="chapter" data-level="11.5" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-bird-alarm-example"><i class="fa fa-check"></i><b>11.5</b> The bird alarm example</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#calculate-the-mle-for-dl-and-f-and-the-likelihood-value-evaluated-at-the-mle"><i class="fa fa-check"></i><b>11.5.1</b> Calculate the MLE for DL and F and the likelihood value evaluated at the MLE</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#where-is-the-evidence-for-different-behavior"><i class="fa fa-check"></i><b>11.6</b> Where is the evidence for different behavior?</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#plot-the-likelihood-for-dead-leaf-gleaners"><i class="fa fa-check"></i><b>11.6.1</b> Plot the likelihood for dead-leaf gleaners</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#are-the-freezing-times-different-for-the-two-groups"><i class="fa fa-check"></i><b>11.7</b> Are the freezing times different for the two groups?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html"><i class="fa fa-check"></i><b>12</b> What is Bayesian statistics?</a>
<ul>
<li class="chapter" data-level="12.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#what-about-all-the-fighting-of-frequentists-vs.-bayesians"><i class="fa fa-check"></i><b>12.1</b> What about all the fighting of “frequentists” vs. “Bayesians”</a></li>
<li class="chapter" data-level="12.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#when-do-we-choose-bayesian-statistics"><i class="fa fa-check"></i><b>12.2</b> When do we choose Bayesian statistics?</a></li>
<li class="chapter" data-level="12.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#basic-concepts-of-bayesian-statistics"><i class="fa fa-check"></i><b>12.3</b> Basic concepts of Bayesian Statistics</a></li>
<li class="chapter" data-level="12.4" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#example-online-dating"><i class="fa fa-check"></i><b>12.4</b> Example: Online dating</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#pab-is-difficult-to-estimate"><i class="fa fa-check"></i><b>12.4.1</b> <span class="math inline">\(P(A|B)\)</span> is difficult to estimate</a></li>
<li class="chapter" data-level="12.4.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#coming-back-to-the-initial-idea-of-how-we-define-bayesian-statistics"><i class="fa fa-check"></i><b>12.4.2</b> Coming back to the initial idea of how we define Bayesian statistics</a></li>
<li class="chapter" data-level="12.4.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-random-variable"><i class="fa fa-check"></i><b>12.4.3</b> The random variable</a></li>
<li class="chapter" data-level="12.4.4" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-prior-distribution"><i class="fa fa-check"></i><b>12.4.4</b> The prior distribution</a></li>
<li class="chapter" data-level="12.4.5" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-data-and-their-distribution"><i class="fa fa-check"></i><b>12.4.5</b> The Data and their distribution</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-likelihood-function-1"><i class="fa fa-check"></i><b>12.5</b> The likelihood function</a></li>
<li class="chapter" data-level="12.6" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-update-the-posterior-distribution"><i class="fa fa-check"></i><b>12.6</b> The update! The posterior distribution</a></li>
<li class="chapter" data-level="12.7" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#optional-section-doing-your-first-mcmc"><i class="fa fa-check"></i><b>12.7</b> Optional section: Doing your first MCMC</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-proposal-function"><i class="fa fa-check"></i><b>12.7.1</b> The proposal function</a></li>
<li class="chapter" data-level="12.7.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-metropolis-hastings"><i class="fa fa-check"></i><b>12.7.2</b> The Metropolis-Hastings</a></li>
<li class="chapter" data-level="12.7.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#visualizing-the-mcmc-as-a-way-to-find-out-convergence"><i class="fa fa-check"></i><b>12.7.3</b> Visualizing the MCMC as a way to find out convergence</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#changing-the-proposal"><i class="fa fa-check"></i><b>12.8</b> Changing the proposal</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html"><i class="fa fa-check"></i><b>13</b> Introduction to macroevolution modeling</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#reading-dataset-and-phylogenetic-tree"><i class="fa fa-check"></i><b>13.1</b> Reading dataset and phylogenetic tree</a></li>
<li class="chapter" data-level="13.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-a-phylogenetic-tree-with-data"><i class="fa fa-check"></i><b>13.2</b> Plotting a phylogenetic tree with data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-continuous-data"><i class="fa fa-check"></i><b>13.2.1</b> Plotting continuous data</a></li>
<li class="chapter" data-level="13.2.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-discrete-and-continuous-data"><i class="fa fa-check"></i><b>13.2.2</b> Plotting discrete and continuous data</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#introduction-to-brownian-motion"><i class="fa fa-check"></i><b>13.3</b> Introduction to Brownian Motion</a></li>
<li class="chapter" data-level="13.4" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#brownian-motion-in-phylogenetic-comparative-methods"><i class="fa fa-check"></i><b>13.4</b> Brownian motion in phylogenetic comparative methods</a></li>
<li class="chapter" data-level="13.5" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#shared-ancestry-and-continuous-character-evolution"><i class="fa fa-check"></i><b>13.5</b> Shared ancestry and continuous character evolution</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#always-visualize-your-data"><i class="fa fa-check"></i><b>13.5.1</b> Always visualize your data</a></li>
<li class="chapter" data-level="13.5.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#fitting-bm-on-flower-length"><i class="fa fa-check"></i><b>13.5.2</b> Fitting BM on flower length</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html"><i class="fa fa-check"></i><b>14</b> Phylogenetic Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#phylogenetic-linear-models"><i class="fa fa-check"></i><b>14.1</b> Phylogenetic Linear Models</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>14.1.1</b> Testing the hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#what-happens-if-the-model-of-evolution-is-not-brownian-motion-but-something-else"><i class="fa fa-check"></i><b>14.2</b> What happens if the model of evolution is not Brownian motion but something else?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html"><i class="fa fa-check"></i><b>15</b> Discrete variable modeling</a>
<ul>
<li class="chapter" data-level="15.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#plotting-discrete-data-on-a-phylogeny"><i class="fa fa-check"></i><b>15.1</b> Plotting discrete data on a phylogeny</a></li>
<li class="chapter" data-level="15.2" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#discrete-character-evolution"><i class="fa fa-check"></i><b>15.2</b> Discrete character evolution</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#what-is-a-q-matrix"><i class="fa fa-check"></i><b>15.2.1</b> What is a Q-matrix?</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#modeling-using-ctmcs"><i class="fa fa-check"></i><b>15.3</b> Modeling using CTMCs</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#modeling-the-transition-rates-between-two-states"><i class="fa fa-check"></i><b>15.3.1</b> Modeling the transition rates between two states</a></li>
<li class="chapter" data-level="15.3.2" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#model-comparison"><i class="fa fa-check"></i><b>15.3.2</b> Model comparison</a></li>
<li class="chapter" data-level="15.3.3" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#stochastic-mapping"><i class="fa fa-check"></i><b>15.3.3</b> Stochastic mapping</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Andes Phylogenomics Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="what-is-bayesian-statistics" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> What is Bayesian statistics?<a href="what-is-bayesian-statistics.html#what-is-bayesian-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Bayesian statistics is a branch of statistics that focuses in inferring and forecasting the probability of events making sure we account for uncertainty.</p>
<p>There are two central differences from traditional (frequentist) statistics</p>
<ol style="list-style-type: decimal">
<li><p>The way Bayesians define probabilities</p></li>
<li><p>Parameters are unknown but random and we need to measure their uncertainty.</p></li>
</ol>
<p>At all times we need to make sure we think about these two key issues.</p>
<div id="what-about-all-the-fighting-of-frequentists-vs.-bayesians" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> What about all the fighting of “frequentists” vs. “Bayesians”<a href="what-is-bayesian-statistics.html#what-about-all-the-fighting-of-frequentists-vs.-bayesians" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>From a practical point of view all the fighting is just a series of bad misunderstandings. Frequentist statistics has a long history of fighting that started early with the introduction of a concept that we have studied <em>likelihood function</em>. Interestingly, people confuse the likelihood function with frequentist statistics, and now people host talks arguing that frequentist (or likelihood statistics) are bad even though likelihood can have the same inference potential than Bayesian statistics.</p>
</div>
<div id="when-do-we-choose-bayesian-statistics" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> When do we choose Bayesian statistics?<a href="what-is-bayesian-statistics.html#when-do-we-choose-bayesian-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Biology we choose Bayesian statistics because they have a powerful computational tool that is called <em>MCMC</em> that stands for Monte Carlo Markov Chain optimization. This tool is extremely easy to implement in new software and deals with very complex models quickly. It is so powerful that an MCMC can give us estimates of many parameters without optimization nightmares. Today we will explore this power.</p>
</div>
<div id="basic-concepts-of-bayesian-statistics" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Basic concepts of Bayesian Statistics<a href="what-is-bayesian-statistics.html#basic-concepts-of-bayesian-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bayesian statistics inherit their from the Bayes’ Theorem. We have two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> so the conditional probability of <span class="math inline">\(A\)</span> <strong>given</strong> <span class="math inline">\(B\)</span> is defined as</p>
<p><span class="math display">\[P(A|B)=\frac{P(AB)}{P(B)}\]</span>
or applying twice Bayes’ Theorem we get</p>
<p><span class="math display">\[ P(A|B)=\frac{P(B|A)P(A)}{P(B)}\]</span></p>
</div>
<div id="example-online-dating" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Example: Online dating<a href="what-is-bayesian-statistics.html#example-online-dating" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dating online can be daunting for introverts. An introvert, lets call them Felix (F), asks a person Pepa (P) out for dinner, and Pepa accepts. F is super nervous and thinking about these two events</p>
<ul>
<li>A: is the event that P is into F</li>
<li>B: is the event that represents a date between F and P going well</li>
</ul>
<p>The probability <span class="math inline">\(P(A)\)</span> represents <em>a priori</em> how much F believes P is into them. For example, <span class="math inline">\(P(A)=0.1\)</span> represents lack of confidence, meaning F doesn’t believe P is that interested in them. An overly confident person can have a <span class="math inline">\(P(A)=0.9\)</span>.</p>
<p>However, F knows how to play the long game. They are interested in <span class="math inline">\(P(A|B)\)</span> meaning, after observing how well and fun their date goes, F can <em>update</em> their expectations, that is, if the dinner goes well, maybe they increased their chances of dating for longer P.</p>
<div id="pab-is-difficult-to-estimate" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> <span class="math inline">\(P(A|B)\)</span> is difficult to estimate<a href="what-is-bayesian-statistics.html#pab-is-difficult-to-estimate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>How do we update the probability of P liking F given how the date went? It is always easier to think on the opposite conditional:</p>
<p><span class="math inline">\(P(B|A)\)</span>: <em>Given that P is into F</em> the probability of dinner going well is…</p>
<p>and we can go beyond this. We can think on the complement of event <span class="math inline">\(A\)</span> denoted as <span class="math inline">\(A^C\)</span> that is the event that P is NOT into F. In probability world the rule is that the complement has a probability
<span class="math display">\[P(A^C)=1-P(A)\]</span>
(the probability of P is not into F is one minus the probability of P liking F, hence complementary probabilities)</p>
</div>
<div id="coming-back-to-the-initial-idea-of-how-we-define-bayesian-statistics" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Coming back to the initial idea of how we define Bayesian statistics<a href="what-is-bayesian-statistics.html#coming-back-to-the-initial-idea-of-how-we-define-bayesian-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>The way Bayesians define probabilities</strong>- It is all about betting. There is no great way to <em>a priori</em> decide what <span class="math inline">\(P(A)\)</span> (the probability of a person liking me). This is subjective and up to the modeler. This is why we want to be careful with prior distributions.</li>
</ol>
</div>
<div id="the-random-variable" class="section level3 hasAnchor" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> The random variable<a href="what-is-bayesian-statistics.html#the-random-variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To become a true Bayesian and be able to infer how dating is going we need to move from the space of events A and B to the space of numbers using an important concept: <strong>random variables</strong>. Random variables represent a <strong>function</strong> that takes us from an event to a number.</p>
<p>Let’s define our first one</p>
<p><span class="math inline">\(A\)</span>: The event that Pepa likes Felix.</p>
<p><span class="math inline">\(X\)</span>: random variable (a function that takes us from an event to a number). Define as</p>
<p><span class="math display">\[X= \begin{cases}
      0 &amp; \textrm{when } A^C  \textrm{ happens}\\
      1 &amp; \textrm{when } A  \textrm{ happens}
    \end{cases}\]</span></p>
<p>So now instead of using the probability <span class="math inline">\(P(A)\)</span> we can use instead <span class="math inline">\(P(X=1)\)</span> and both mean the same.</p>
</div>
<div id="the-prior-distribution" class="section level3 hasAnchor" number="12.4.4">
<h3><span class="header-section-number">12.4.4</span> The prior distribution<a href="what-is-bayesian-statistics.html#the-prior-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now suppose that <span class="math inline">\(P(X=1)\)</span> is redefined using a parameter called <span class="math inline">\(\theta\)</span> (theta) that is between 0 and 1, and this also means that <span class="math inline">\(P(X=0)=1-\theta\)</span>. Just like Felix declared his shyness initially <span class="math inline">\(\theta=0.1\)</span>. That would be all well if you are completely certain, but as any person in the world, sometimes a person likes you and sometimes they don’t. So it would be much better to assume <span class="math inline">\(\theta\)</span> (parameter) is uncertain and try to model it.</p>
<p>For that we are going to use a probability distribution called <strong>Beta</strong>. A beta distribution is convenient because it goes from (0, 1). You could choose any other distribution you wish as long as it makes <span class="math inline">\(\theta\)</span> go between (0,1).
Beta has two parameters a and b and the mean of the distribution is a/(a+b).
Assign the value 0.1 to the variable <code>theta</code>, 2 to the variable <code>a</code>, and 5 to the variable <code>b</code>.</p>
<p>But let’s explore what a Beta distribution does.
Create a function that takes theta, a, and b as arguments.
The function should return <code>dbeta(theta, a, b)</code>.</p>
<p>Load the library <code>tidyverse</code>.</p>
<p>Create a table of values a and b so we can see the different shapes of Beta distribution</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="what-is-bayesian-statistics.html#cb80-1" aria-hidden="true" tabindex="-1"></a>length <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb80-2"><a href="what-is-bayesian-statistics.html#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="what-is-bayesian-statistics.html#cb80-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb80-4"><a href="what-is-bayesian-statistics.html#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">shape1 =</span> <span class="fu">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb80-5"><a href="what-is-bayesian-statistics.html#cb80-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape2 =</span> <span class="fu">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-6"><a href="what-is-bayesian-statistics.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(shape1, shape2), </span>
<span id="cb80-7"><a href="what-is-bayesian-statistics.html#cb80-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> length)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-8"><a href="what-is-bayesian-statistics.html#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">a     =</span> <span class="fu">str_c</span>(<span class="st">&quot;a =&quot;</span>, shape1),</span>
<span id="cb80-9"><a href="what-is-bayesian-statistics.html#cb80-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">b     =</span> <span class="fu">str_c</span>(<span class="st">&quot;b =&quot;</span>, shape2),</span>
<span id="cb80-10"><a href="what-is-bayesian-statistics.html#cb80-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>length, <span class="at">each =</span> <span class="dv">25</span>))</span></code></pre></div>
<p>Use the <code>head</code> function to see what is in the table</p>
<p>Now plot different Beta distributions</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="what-is-bayesian-statistics.html#cb81-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="what-is-bayesian-statistics.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">group =</span> group)) <span class="sc">+</span></span>
<span id="cb81-3"><a href="what-is-bayesian-statistics.html#cb81-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-4"><a href="what-is-bayesian-statistics.html#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">dbeta</span>(x, <span class="at">shape1 =</span> shape1, <span class="at">shape2 =</span> shape2)),</span>
<span id="cb81-5"><a href="what-is-bayesian-statistics.html#cb81-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">size =</span> <span class="fl">1.25</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="what-is-bayesian-statistics.html#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>)) <span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb81-7"><a href="what-is-bayesian-statistics.html#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb81-8"><a href="what-is-bayesian-statistics.html#cb81-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;p(&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="sc">+</span></span>
<span id="cb81-9"><a href="what-is-bayesian-statistics.html#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb81-10"><a href="what-is-bayesian-statistics.html#cb81-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(b<span class="sc">~</span>a)</span></code></pre></div>
<p>Let’s interpret the Beta distributions. These are potential prior distributions, they are subjective and represent different beliefs that we have about the statisticians.</p>
<p>Here, we are focusing on the second central idea of Bayesian statistics:</p>
<ol start="2" style="list-style-type: decimal">
<li>Parameters are unknown but random and we need to measure their uncertainty.</li>
</ol>
<p>We do this by assuming the parameter <span class="math inline">\(\theta\)</span> has a <strong>prior distribution</strong> <span class="math inline">\(Beta(a,b)\)</span>.</p>
</div>
<div id="the-data-and-their-distribution" class="section level3 hasAnchor" number="12.4.5">
<h3><span class="header-section-number">12.4.5</span> The Data and their distribution<a href="what-is-bayesian-statistics.html#the-data-and-their-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In our case, Felix goes out for one dinner (or more) trying to figure out if Pepa is interested. Let’s assume a crazy Netflix show scenario (like “Love is Blind”- don’t judge me!). Felix and Pepa decide to date for exactly three dates <span class="math inline">\(N=3\)</span>. How can we model this?</p>
<p><span class="math display">\[Y \textrm{ is the random variable of the number of dates that went well so the values } Y=0,1,2,...,N \textrm{ are our only possibilities}\]</span>
The probability of the number of dates that went well is going to be dependent on the likability of the statistician <span class="math inline">\(\theta\)</span>. We can model this using a Binomial distribution
<span class="math display">\[P(Y=k|\theta)= {N\choose k} \theta^k (1-\theta)^{N-k}\]</span>
Let’s see what this Binomial distribution looks like</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="what-is-bayesian-statistics.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(grid)</span></span>
<span id="cb82-2"><a href="what-is-bayesian-statistics.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb82-3"><a href="what-is-bayesian-statistics.html#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="what-is-bayesian-statistics.html#cb82-4" aria-hidden="true" tabindex="-1"></a>date_number <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb82-5"><a href="what-is-bayesian-statistics.html#cb82-5" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb82-6"><a href="what-is-bayesian-statistics.html#cb82-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> date_number, <span class="at">y =</span> <span class="fu">dbinom</span>(date_number, <span class="dv">3</span>, <span class="fl">0.1</span>))</span>
<span id="cb82-7"><a href="what-is-bayesian-statistics.html#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="what-is-bayesian-statistics.html#cb82-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">col =</span> <span class="st">&quot;hotpink&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;hotpink&quot;</span>) <span class="sc">+</span> </span>
<span id="cb82-9"><a href="what-is-bayesian-statistics.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">0</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;x&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Density&quot;</span>) <span class="sc">+</span> </span>
<span id="cb82-10"><a href="what-is-bayesian-statistics.html#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;dbinom(x, 20, 0.5)&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="dv">16</span>, <span class="st">&quot;serif&quot;</span>) <span class="sc">+</span> </span>
<span id="cb82-11"><a href="what-is-bayesian-statistics.html#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.2</span>), <span class="at">vjust =</span> <span class="fl">1.5</span>))<span class="sc">+</span><span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Binomial distribution&quot;</span>, <span class="at">x =</span><span class="st">&quot;Number of dates that went well&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Probability&quot;</span>)</span>
<span id="cb82-12"><a href="what-is-bayesian-statistics.html#cb82-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-13"><a href="what-is-bayesian-statistics.html#cb82-13" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
</div>
</div>
<div id="the-likelihood-function-1" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> The likelihood function<a href="what-is-bayesian-statistics.html#the-likelihood-function-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Likelihood approaches have gotten a bad rap over the years. The likelihood function often gets bunked as a “frequentist” approach. This is incorrect, likelihood functions are extremely useful depending the problem, and they are better understood if we think of them as the function of evidence (discussion to come).</p>
<p>Let’s say the three dates are completed and 2 out of the 3 went well therefore the probability of 2 dates going well is</p>
<p><span class="math display">\[P(Y=2|\theta)= {3\choose 2} \theta^2 (1-\theta)^1\]</span>
If <span class="math inline">\(\theta=0.1\)</span> then <span class="math inline">\(P(Y=2|\theta=0.1)= {3\choose 2} 0.1^2 (0.9)^1=0.027\)</span>. So if Felix is not a likable person the probability of two dates going well is really low 2.7%. This is an <em>unlikely</em> scenario (you see where the word likelihood comes from now?).</p>
<p>Now, let’s think that this Netflix show goes crazier and Felix has to date two people three times. With the first person they have <span class="math inline">\(y_1=1\)</span> good date and with the second <span class="math inline">\(y_2=2\)</span> good dates. Then the likelihood function in this situation is</p>
<p><span class="math display">\[P(Y=y_1|\theta)\times P(Y=y_2|\theta) = {3\choose 1} \theta^1 (1-\theta)^{2}\times {3\choose 2} \theta^2 (1-\theta)^{1} \approx \theta^{1+2}(1-\theta)^{2+1}=\theta^3(1-\theta)^3\]</span>
Formally, <strong>the likelihood function</strong> is the probability of the data given the model, and that is a product of the individual probabilities of each couple dating.</p>
<p><span class="math display">\[P(Data|\theta)= \prod_{y_i=1}^{2}P(Y=y_i|\theta)\approx \theta^3(1-\theta)^3\]</span>
If you didn’t have any information a priori about <span class="math inline">\(\theta\)</span>, what would you say about it after observing that in the first three dates two went well, and in the second three dates only one went well?</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="what-is-bayesian-statistics.html#cb83-1" aria-hidden="true" tabindex="-1"></a>binomial_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(theta, data,n) {</span>
<span id="cb83-2"><a href="what-is-bayesian-statistics.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-3"><a href="what-is-bayesian-statistics.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `theta` = success probability parameter ranging from 0 to 1</span></span>
<span id="cb83-4"><a href="what-is-bayesian-statistics.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># `data`  = the vector of data (i.e., a series of 0s and 1s)</span></span>
<span id="cb83-5"><a href="what-is-bayesian-statistics.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  long <span class="ot">&lt;-</span> <span class="fu">length</span>(theta)</span>
<span id="cb83-6"><a href="what-is-bayesian-statistics.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,long)</span>
<span id="cb83-7"><a href="what-is-bayesian-statistics.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>long){</span>
<span id="cb83-8"><a href="what-is-bayesian-statistics.html#cb83-8" aria-hidden="true" tabindex="-1"></a>  prob.vect <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data,<span class="at">FUN=</span>dbinom, <span class="at">size=</span>n, <span class="at">prob=</span>theta[i])</span>
<span id="cb83-9"><a href="what-is-bayesian-statistics.html#cb83-9" aria-hidden="true" tabindex="-1"></a>  z[i] <span class="ot">&lt;-</span> <span class="fu">prod</span>(prob.vect)</span>
<span id="cb83-10"><a href="what-is-bayesian-statistics.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-11"><a href="what-is-bayesian-statistics.html#cb83-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(z)</span>
<span id="cb83-12"><a href="what-is-bayesian-statistics.html#cb83-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-13"><a href="what-is-bayesian-statistics.html#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="what-is-bayesian-statistics.html#cb83-14" aria-hidden="true" tabindex="-1"></a>observed_dates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb83-15"><a href="what-is-bayesian-statistics.html#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="fu">binomial_likelihood</span>(<span class="at">theta=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>), <span class="at">data=</span>observed_dates,<span class="at">n=</span><span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="the-update-the-posterior-distribution" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> The update! The posterior distribution<a href="what-is-bayesian-statistics.html#the-update-the-posterior-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The posterior distribution then is the updated probability of likability of Felix. After going for some dates, they should have a better way to say “I’m a nice person to go out with”. That’s why Bayesians refer to posterior distributions as updated probabilities.</p>
<p>The posterior distribution is <strong>proportional</strong> to the likelihood multiplied by a prior distribution for the model
<span class="math display">\[\underbrace{P(\theta|Data)}_{Posterior} \propto \underbrace{P(Data|\theta)}_{Likelihood} \times \underbrace{P(\theta)}_{Prior}\]</span>
Remember the proportional part comes from ignoring in the Bayes’ Rule the denominator .That is, we ignore the probability of the data aggregated for all the possible models for <span class="math inline">\(\theta\)</span> that is <span class="math inline">\(P(\theta)\)</span>.</p>
<p>Okay so let’s calculate the posterior distribution</p>
<p><span class="math display">\[P(\theta|Data) \propto \underbrace{\theta^k(1-\theta)^{n-k}}_{\textrm{Likelihood (product of binomials)}} \times \underbrace{\theta^{a-1}(1-\theta)^{b-1}}_{\textrm{prior Beta distribution}}\]</span>
This is a horrible object, how do we deal with this? how do we know how the posterior looks like?</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="what-is-bayesian-statistics.html#cb84-1" aria-hidden="true" tabindex="-1"></a>trial_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb84-2"><a href="what-is-bayesian-statistics.html#cb84-2" aria-hidden="true" tabindex="-1"></a>number_dates <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb84-3"><a href="what-is-bayesian-statistics.html#cb84-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb84-4"><a href="what-is-bayesian-statistics.html#cb84-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb84-5"><a href="what-is-bayesian-statistics.html#cb84-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-6"><a href="what-is-bayesian-statistics.html#cb84-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb84-7"><a href="what-is-bayesian-statistics.html#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">theta0 =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb84-8"><a href="what-is-bayesian-statistics.html#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Prior (beta)</span><span class="st">`</span>           <span class="ot">=</span> <span class="fu">dbeta</span>(theta0, </span>
<span id="cb84-9"><a href="what-is-bayesian-statistics.html#cb84-9" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape1 =</span> a, </span>
<span id="cb84-10"><a href="what-is-bayesian-statistics.html#cb84-10" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape2 =</span> b),</span>
<span id="cb84-11"><a href="what-is-bayesian-statistics.html#cb84-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Likelihood (Binomial)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">binomial_likelihood</span>(<span class="at">theta =</span> theta0, <span class="at">data=</span>trial_data,<span class="at">n=</span>number_dates),</span>
<span id="cb84-12"><a href="what-is-bayesian-statistics.html#cb84-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Posterior (beta)</span><span class="st">`</span>       <span class="ot">=</span> <span class="fu">dbeta</span>(theta0, </span>
<span id="cb84-13"><a href="what-is-bayesian-statistics.html#cb84-13" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape1 =</span> <span class="dv">4</span>, </span>
<span id="cb84-14"><a href="what-is-bayesian-statistics.html#cb84-14" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">shape2 =</span> <span class="dv">7</span>))</span>
<span id="cb84-15"><a href="what-is-bayesian-statistics.html#cb84-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-16"><a href="what-is-bayesian-statistics.html#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d)</span>
<span id="cb84-17"><a href="what-is-bayesian-statistics.html#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="what-is-bayesian-statistics.html#cb84-18" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb84-19"><a href="what-is-bayesian-statistics.html#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(key, value, <span class="sc">-</span>theta0) <span class="sc">%&gt;%</span> </span>
<span id="cb84-20"><a href="what-is-bayesian-statistics.html#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">key =</span> <span class="fu">factor</span>(key, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Likelihood (Binomial)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb84-21"><a href="what-is-bayesian-statistics.html#cb84-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb84-22"><a href="what-is-bayesian-statistics.html#cb84-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta0)) <span class="sc">+</span></span>
<span id="cb84-23"><a href="what-is-bayesian-statistics.html#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># densities</span></span>
<span id="cb84-24"><a href="what-is-bayesian-statistics.html#cb84-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> value),</span>
<span id="cb84-25"><a href="what-is-bayesian-statistics.html#cb84-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="sc">+</span></span>
<span id="cb84-26"><a href="what-is-bayesian-statistics.html#cb84-26" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(theta),</span>
<span id="cb84-27"><a href="what-is-bayesian-statistics.html#cb84-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb84-28"><a href="what-is-bayesian-statistics.html#cb84-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb84-29"><a href="what-is-bayesian-statistics.html#cb84-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p>The goal in any Bayesian statistics inference is to get the posterior distribution and this is done using a computational algorithm called the MCMC- Markov Chain Monte Carlo that allows us to propose values for <span class="math inline">\(/theta\)</span> from and accept of reject them depending on the odds that the data is likely under those values.</p>
</div>
<div id="optional-section-doing-your-first-mcmc" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Optional section: Doing your first MCMC<a href="what-is-bayesian-statistics.html#optional-section-doing-your-first-mcmc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The MCMC (Markov Chain Monte Carlo) algorithm allow us to characterize and optimize the posterior distributions of all the parameters of interest. The MCMC you will be doing today is a Metropolis-Hastings, it is a rejection algorithm, it proposes a value for the parameter <span class="math inline">\(\theta\)</span> and then asks: Does that value improves the posterior probability?
If yes then accept it other wise, go back and propose something new.</p>
<p>Hands on!</p>
<div id="the-proposal-function" class="section level3 hasAnchor" number="12.7.1">
<h3><span class="header-section-number">12.7.1</span> The proposal function<a href="what-is-bayesian-statistics.html#the-proposal-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are going to propose a <span class="math inline">\(\theta_{new}\)</span></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="what-is-bayesian-statistics.html#cb85-1" aria-hidden="true" tabindex="-1"></a>proposalfunction <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nvals=</span><span class="dv">1</span>){</span>
<span id="cb85-2"><a href="what-is-bayesian-statistics.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  unif_val <span class="ot">&lt;-</span> <span class="fu">runif</span>(nvals,<span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb85-3"><a href="what-is-bayesian-statistics.html#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(unif_val)</span>
<span id="cb85-4"><a href="what-is-bayesian-statistics.html#cb85-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-5"><a href="what-is-bayesian-statistics.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Select randomly a value for theta from a uniform distribution</span></span></code></pre></div>
</div>
<div id="the-metropolis-hastings" class="section level3 hasAnchor" number="12.7.2">
<h3><span class="header-section-number">12.7.2</span> The Metropolis-Hastings<a href="what-is-bayesian-statistics.html#the-metropolis-hastings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is the rejection algorithm that we want. We are going to select a starting value for theta our search <code>startvalue</code> and a number of times we want to keep searching for new values <code>iterations</code> the number of times we search will depend completely on whether we achieve convergence (more about convergence to follow).</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="what-is-bayesian-statistics.html#cb86-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb86-2"><a href="what-is-bayesian-statistics.html#cb86-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb86-3"><a href="what-is-bayesian-statistics.html#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="what-is-bayesian-statistics.html#cb86-4" aria-hidden="true" tabindex="-1"></a>run_metropolis_MCMC <span class="ot">&lt;-</span> <span class="cf">function</span>(startvalue, iterations){</span>
<span id="cb86-5"><a href="what-is-bayesian-statistics.html#cb86-5" aria-hidden="true" tabindex="-1"></a>    chain <span class="ot">=</span> <span class="fu">rep</span> (<span class="dv">0</span>,iterations<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb86-6"><a href="what-is-bayesian-statistics.html#cb86-6" aria-hidden="true" tabindex="-1"></a>    chain[<span class="dv">1</span>] <span class="ot">=</span> startvalue <span class="co"># our algorithm starts here with a set of start values</span></span>
<span id="cb86-7"><a href="what-is-bayesian-statistics.html#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iterations){</span>
<span id="cb86-8"><a href="what-is-bayesian-statistics.html#cb86-8" aria-hidden="true" tabindex="-1"></a>        theta_old<span class="ot">&lt;-</span>chain[i]</span>
<span id="cb86-9"><a href="what-is-bayesian-statistics.html#cb86-9" aria-hidden="true" tabindex="-1"></a>        theta_new <span class="ot">=</span> <span class="fu">proposalfunction</span>(<span class="dv">1</span>) <span class="co"># We propose to move somewhere else, utilizing as the mean of our normal distribution for the proposal the current values we have</span></span>
<span id="cb86-10"><a href="what-is-bayesian-statistics.html#cb86-10" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb86-11"><a href="what-is-bayesian-statistics.html#cb86-11" aria-hidden="true" tabindex="-1"></a>        odds <span class="ot">=</span> (<span class="fu">binomial_likelihood</span>(theta_new,observed_dates,<span class="at">n=</span><span class="dv">3</span>)<span class="sc">*</span><span class="fu">prior_distribution</span>(theta_new, a,b))<span class="sc">/</span>(<span class="fu">binomial_likelihood</span>(theta_old,observed_dates,<span class="at">n=</span><span class="dv">3</span>)<span class="sc">*</span><span class="fu">prior_distribution</span>(theta_old, a,b)) </span>
<span id="cb86-12"><a href="what-is-bayesian-statistics.html#cb86-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb86-13"><a href="what-is-bayesian-statistics.html#cb86-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> odds){  <span class="co">#if that difference in probability is really big, then awesome we are exploring better the posterior and we should take the proposed values</span></span>
<span id="cb86-14"><a href="what-is-bayesian-statistics.html#cb86-14" aria-hidden="true" tabindex="-1"></a>            chain[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> theta_new</span>
<span id="cb86-15"><a href="what-is-bayesian-statistics.html#cb86-15" aria-hidden="true" tabindex="-1"></a>        }<span class="cf">else</span>{ <span class="co"># not great, better stay where we are and not move, in the next round we will propose other values maybe better ones.</span></span>
<span id="cb86-16"><a href="what-is-bayesian-statistics.html#cb86-16" aria-hidden="true" tabindex="-1"></a>            chain[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> theta_old</span>
<span id="cb86-17"><a href="what-is-bayesian-statistics.html#cb86-17" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb86-18"><a href="what-is-bayesian-statistics.html#cb86-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb86-19"><a href="what-is-bayesian-statistics.html#cb86-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(chain)</span>
<span id="cb86-20"><a href="what-is-bayesian-statistics.html#cb86-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-21"><a href="what-is-bayesian-statistics.html#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="what-is-bayesian-statistics.html#cb86-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-23"><a href="what-is-bayesian-statistics.html#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Test case do only one step, what happened? Compare amongst your classmates</span></span>
<span id="cb86-24"><a href="what-is-bayesian-statistics.html#cb86-24" aria-hidden="true" tabindex="-1"></a>startvalue <span class="ot">=</span> <span class="fl">0.3</span> <span class="co"># Here is the start value</span></span>
<span id="cb86-25"><a href="what-is-bayesian-statistics.html#cb86-25" aria-hidden="true" tabindex="-1"></a>chain <span class="ot">=</span> <span class="fu">run_metropolis_MCMC</span>(startvalue, <span class="dv">1</span>) <span class="co"># Do one step, what happened?</span></span>
<span id="cb86-26"><a href="what-is-bayesian-statistics.html#cb86-26" aria-hidden="true" tabindex="-1"></a>chain</span>
<span id="cb86-27"><a href="what-is-bayesian-statistics.html#cb86-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-28"><a href="what-is-bayesian-statistics.html#cb86-28" aria-hidden="true" tabindex="-1"></a>startvalue <span class="ot">=</span> <span class="fl">0.3</span> <span class="co"># Here is the start value</span></span>
<span id="cb86-29"><a href="what-is-bayesian-statistics.html#cb86-29" aria-hidden="true" tabindex="-1"></a>iter<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb86-30"><a href="what-is-bayesian-statistics.html#cb86-30" aria-hidden="true" tabindex="-1"></a>chain <span class="ot">=</span> <span class="fu">run_metropolis_MCMC</span>(startvalue, iter) <span class="co"># Do 10,000 steps</span></span>
<span id="cb86-31"><a href="what-is-bayesian-statistics.html#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(chain)</span></code></pre></div>
</div>
<div id="visualizing-the-mcmc-as-a-way-to-find-out-convergence" class="section level3 hasAnchor" number="12.7.3">
<h3><span class="header-section-number">12.7.3</span> Visualizing the MCMC as a way to find out convergence<a href="what-is-bayesian-statistics.html#visualizing-the-mcmc-as-a-way-to-find-out-convergence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="what-is-bayesian-statistics.html#cb87-1" aria-hidden="true" tabindex="-1"></a>mcmc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">iterations=</span><span class="fu">seq</span>(<span class="dv">1</span>,iter<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>),chain)</span>
<span id="cb87-2"><a href="what-is-bayesian-statistics.html#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="what-is-bayesian-statistics.html#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb87-4"><a href="what-is-bayesian-statistics.html#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mcmc, <span class="fu">aes</span>(<span class="at">x=</span>iterations, <span class="at">y=</span>chain)) <span class="sc">+</span></span>
<span id="cb87-5"><a href="what-is-bayesian-statistics.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;hotpink&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-6"><a href="what-is-bayesian-statistics.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;MCMC run&quot;</span>,<span class="at">x=</span><span class="st">&quot;Iterations&quot;</span>, <span class="at">y=</span><span class="st">&quot;Posterior distribution&quot;</span>)</span>
<span id="cb87-7"><a href="what-is-bayesian-statistics.html#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="what-is-bayesian-statistics.html#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(chain,<span class="at">col=</span><span class="st">&quot;hotpink&quot;</span>)</span>
<span id="cb87-9"><a href="what-is-bayesian-statistics.html#cb87-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-10"><a href="what-is-bayesian-statistics.html#cb87-10" aria-hidden="true" tabindex="-1"></a>acceptance <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(<span class="fu">duplicated</span>(chain)) <span class="co"># The proportion of accepted moves, how did it go? good or bad</span></span>
<span id="cb87-11"><a href="what-is-bayesian-statistics.html#cb87-11" aria-hidden="true" tabindex="-1"></a>acceptance</span></code></pre></div>
</div>
</div>
<div id="changing-the-proposal" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> Changing the proposal<a href="what-is-bayesian-statistics.html#changing-the-proposal" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="what-is-bayesian-statistics.html#cb88-1" aria-hidden="true" tabindex="-1"></a>proposalfunction2 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nvals=</span><span class="dv">1</span>){</span>
<span id="cb88-2"><a href="what-is-bayesian-statistics.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  beta_val<span class="ot">&lt;-</span><span class="fu">rbeta</span>(nvals, <span class="at">shape1=</span><span class="fl">0.1</span>, <span class="at">shape2=</span><span class="fl">0.1</span>) <span class="co"># Beta that looks like a U</span></span>
<span id="cb88-3"><a href="what-is-bayesian-statistics.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(beta_val)</span>
<span id="cb88-4"><a href="what-is-bayesian-statistics.html#cb88-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-5"><a href="what-is-bayesian-statistics.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb88-6"><a href="what-is-bayesian-statistics.html#cb88-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb88-7"><a href="what-is-bayesian-statistics.html#cb88-7" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb88-8"><a href="what-is-bayesian-statistics.html#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="what-is-bayesian-statistics.html#cb88-9" aria-hidden="true" tabindex="-1"></a>run_metropolis_MCMC2 <span class="ot">&lt;-</span> <span class="cf">function</span>(startvalue, iterations){</span>
<span id="cb88-10"><a href="what-is-bayesian-statistics.html#cb88-10" aria-hidden="true" tabindex="-1"></a>    chain <span class="ot">=</span> <span class="fu">rep</span> (<span class="dv">0</span>,iterations<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb88-11"><a href="what-is-bayesian-statistics.html#cb88-11" aria-hidden="true" tabindex="-1"></a>    chain[<span class="dv">1</span>] <span class="ot">=</span> startvalue <span class="co"># our algorithm starts here with a set of start values</span></span>
<span id="cb88-12"><a href="what-is-bayesian-statistics.html#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iterations){</span>
<span id="cb88-13"><a href="what-is-bayesian-statistics.html#cb88-13" aria-hidden="true" tabindex="-1"></a>        theta_old<span class="ot">&lt;-</span>chain[i]</span>
<span id="cb88-14"><a href="what-is-bayesian-statistics.html#cb88-14" aria-hidden="true" tabindex="-1"></a>        theta_new <span class="ot">=</span> <span class="fu">proposalfunction2</span>(<span class="dv">1</span>) <span class="co"># We propose to move somewhere else, utilizing as the mean of our normal distribution for the proposal the current values we have</span></span>
<span id="cb88-15"><a href="what-is-bayesian-statistics.html#cb88-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb88-16"><a href="what-is-bayesian-statistics.html#cb88-16" aria-hidden="true" tabindex="-1"></a>        odds <span class="ot">=</span> (<span class="fu">binomial_likelihood</span>(theta_new,observed_dates,<span class="at">n=</span><span class="dv">3</span>)<span class="sc">*</span><span class="fu">prior_distribution</span>(theta_new, a,b))<span class="sc">/</span>(<span class="fu">binomial_likelihood</span>(theta_old,observed_dates,<span class="at">n=</span><span class="dv">3</span>)<span class="sc">*</span><span class="fu">prior_distribution</span>(theta_old, a,b)) </span>
<span id="cb88-17"><a href="what-is-bayesian-statistics.html#cb88-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb88-18"><a href="what-is-bayesian-statistics.html#cb88-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> odds){  <span class="co">#if that difference in probability is really big, then awesome we are exploring better the posterior and we should take the proposed values</span></span>
<span id="cb88-19"><a href="what-is-bayesian-statistics.html#cb88-19" aria-hidden="true" tabindex="-1"></a>            chain[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> theta_new</span>
<span id="cb88-20"><a href="what-is-bayesian-statistics.html#cb88-20" aria-hidden="true" tabindex="-1"></a>        }<span class="cf">else</span>{ <span class="co"># not great, better stay where we are and not move, in the next round we will propose other values maybe better ones.</span></span>
<span id="cb88-21"><a href="what-is-bayesian-statistics.html#cb88-21" aria-hidden="true" tabindex="-1"></a>            chain[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> theta_old</span>
<span id="cb88-22"><a href="what-is-bayesian-statistics.html#cb88-22" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb88-23"><a href="what-is-bayesian-statistics.html#cb88-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-24"><a href="what-is-bayesian-statistics.html#cb88-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(chain)</span>
<span id="cb88-25"><a href="what-is-bayesian-statistics.html#cb88-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-26"><a href="what-is-bayesian-statistics.html#cb88-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-27"><a href="what-is-bayesian-statistics.html#cb88-27" aria-hidden="true" tabindex="-1"></a>startvalue <span class="ot">=</span> <span class="fl">0.3</span> <span class="co"># Here is the start value</span></span>
<span id="cb88-28"><a href="what-is-bayesian-statistics.html#cb88-28" aria-hidden="true" tabindex="-1"></a>iter<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb88-29"><a href="what-is-bayesian-statistics.html#cb88-29" aria-hidden="true" tabindex="-1"></a>chain <span class="ot">=</span> <span class="fu">run_metropolis_MCMC2</span>(startvalue, iter) <span class="co"># Do 10,000 steps</span></span>
<span id="cb88-30"><a href="what-is-bayesian-statistics.html#cb88-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-31"><a href="what-is-bayesian-statistics.html#cb88-31" aria-hidden="true" tabindex="-1"></a>mcmc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">iterations=</span><span class="fu">seq</span>(<span class="dv">1</span>,iter<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>),chain)</span>
<span id="cb88-32"><a href="what-is-bayesian-statistics.html#cb88-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-33"><a href="what-is-bayesian-statistics.html#cb88-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb88-34"><a href="what-is-bayesian-statistics.html#cb88-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mcmc, <span class="fu">aes</span>(<span class="at">x=</span>iterations, <span class="at">y=</span>chain)) <span class="sc">+</span></span>
<span id="cb88-35"><a href="what-is-bayesian-statistics.html#cb88-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;hotpink&quot;</span>)<span class="sc">+</span></span>
<span id="cb88-36"><a href="what-is-bayesian-statistics.html#cb88-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;MCMC run&quot;</span>,<span class="at">x=</span><span class="st">&quot;Iterations&quot;</span>, <span class="at">y=</span><span class="st">&quot;Posterior distribution&quot;</span>)</span>
<span id="cb88-37"><a href="what-is-bayesian-statistics.html#cb88-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-38"><a href="what-is-bayesian-statistics.html#cb88-38" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(chain,<span class="at">col=</span><span class="st">&quot;hotpink&quot;</span>)</span>
<span id="cb88-39"><a href="what-is-bayesian-statistics.html#cb88-39" aria-hidden="true" tabindex="-1"></a>acceptance <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(<span class="fu">duplicated</span>(chain)) <span class="co"># The proportion of accepted moves, how did it go? good or bad</span></span>
<span id="cb88-40"><a href="what-is-bayesian-statistics.html#cb88-40" aria-hidden="true" tabindex="-1"></a>acceptance</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="understanding-the-likelihood-function.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="introduction-to-macroevolution-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/12-bayesian.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
