<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Trait Data | Andes Phylogenomics Workshop</title>
  <meta name="description" content="Step-by-step guide to a project in phylogenomics." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Trait Data | Andes Phylogenomics Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Step-by-step guide to a project in phylogenomics." />
  <meta name="github-repo" content="rachelss/Andes_workshop_codebook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Trait Data | Andes Phylogenomics Workshop" />
  
  <meta name="twitter:description" content="Step-by-step guide to a project in phylogenomics." />
  

<meta name="author" content="Rachel Schwartz and Rosana Zenil-Ferguson" />


<meta name="date" content="2023-07-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-and-analysis.html"/>
<link rel="next" href="computational-skills.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Andes Phylogenomics Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this workshop</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#case-studies"><i class="fa fa-check"></i><b>2.2</b> Case Studies</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#course-objectives"><i class="fa fa-check"></i><b>2.3</b> Course Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-and-analysis.html"><a href="data-and-analysis.html"><i class="fa fa-check"></i><b>3</b> Data and analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-and-analysis.html"><a href="data-and-analysis.html#genomic-data"><i class="fa fa-check"></i><b>3.1</b> Genomic data</a></li>
<li class="chapter" data-level="3.2" data-path="data-and-analysis.html"><a href="data-and-analysis.html#phylogenies"><i class="fa fa-check"></i><b>3.2</b> Phylogenies</a></li>
<li class="chapter" data-level="3.3" data-path="data-and-analysis.html"><a href="data-and-analysis.html#comparative-analyses"><i class="fa fa-check"></i><b>3.3</b> Comparative analyses</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="trait-data.html"><a href="trait-data.html"><i class="fa fa-check"></i><b>4</b> Trait Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="trait-data.html"><a href="trait-data.html#getting-started-with-r"><i class="fa fa-check"></i><b>4.1</b> Getting started with R</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="trait-data.html"><a href="trait-data.html#option-1-log-in-to-the-server"><i class="fa fa-check"></i><b>4.1.1</b> Option 1: Log in to the server</a></li>
<li class="chapter" data-level="4.1.2" data-path="trait-data.html"><a href="trait-data.html#option-2-work-on-your-personal-computer"><i class="fa fa-check"></i><b>4.1.2</b> Option 2: Work on your personal computer</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="trait-data.html"><a href="trait-data.html#load-and-set-up-data"><i class="fa fa-check"></i><b>4.2</b> Load and set up data</a></li>
<li class="chapter" data-level="4.3" data-path="trait-data.html"><a href="trait-data.html#beginning-an-analysis"><i class="fa fa-check"></i><b>4.3</b> Beginning an analysis</a></li>
<li class="chapter" data-level="4.4" data-path="trait-data.html"><a href="trait-data.html#data-visualization"><i class="fa fa-check"></i><b>4.4</b> Data Visualization</a></li>
<li class="chapter" data-level="4.5" data-path="trait-data.html"><a href="trait-data.html#statistical-tests-of-relationships"><i class="fa fa-check"></i><b>4.5</b> Statistical tests of relationships</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="computational-skills.html"><a href="computational-skills.html"><i class="fa fa-check"></i><b>5</b> Computational skills</a>
<ul>
<li class="chapter" data-level="5.1" data-path="computational-skills.html"><a href="computational-skills.html#basic-navigation"><i class="fa fa-check"></i><b>5.1</b> Basic navigation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="getting-your-data.html"><a href="getting-your-data.html"><i class="fa fa-check"></i><b>6</b> Getting your data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="getting-your-data.html"><a href="getting-your-data.html#repeating-analyses"><i class="fa fa-check"></i><b>6.1</b> Repeating analyses</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tree-thinking-quiz.html"><a href="tree-thinking-quiz.html"><i class="fa fa-check"></i><b>7</b> Tree thinking quiz</a></li>
<li class="chapter" data-level="8" data-path="target-capture-data.html"><a href="target-capture-data.html"><i class="fa fa-check"></i><b>8</b> Target capture data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="target-capture-data.html"><a href="target-capture-data.html#background"><i class="fa fa-check"></i><b>8.1</b> Background</a></li>
<li class="chapter" data-level="8.2" data-path="target-capture-data.html"><a href="target-capture-data.html#running-hybpiper-to-assemble-genes"><i class="fa fa-check"></i><b>8.2</b> Running HybPiper to assemble genes</a></li>
<li class="chapter" data-level="8.3" data-path="target-capture-data.html"><a href="target-capture-data.html#hybpiper-outputs"><i class="fa fa-check"></i><b>8.3</b> Hybpiper outputs</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="target-capture-data.html"><a href="target-capture-data.html#viewing-information"><i class="fa fa-check"></i><b>8.3.1</b> Viewing information</a></li>
<li class="chapter" data-level="8.3.2" data-path="target-capture-data.html"><a href="target-capture-data.html#obtain-gene-data"><i class="fa fa-check"></i><b>8.3.2</b> Obtain gene data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="target-capture-data.html"><a href="target-capture-data.html#visual-inspection-of-data"><i class="fa fa-check"></i><b>8.4</b> Visual inspection of data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>9</b> Results</a>
<ul>
<li class="chapter" data-level="9.1" data-path="results.html"><a href="results.html#alignment"><i class="fa fa-check"></i><b>9.1</b> Alignment</a></li>
<li class="chapter" data-level="9.2" data-path="results.html"><a href="results.html#view-in-r"><i class="fa fa-check"></i><b>9.2</b> View in R</a></li>
<li class="chapter" data-level="9.3" data-path="results.html"><a href="results.html#concatenated-data-analysis"><i class="fa fa-check"></i><b>9.3</b> Concatenated data analysis</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="results.html"><a href="results.html#building-trees-with-iqtree"><i class="fa fa-check"></i><b>9.3.1</b> Building trees with IQTree</a></li>
<li class="chapter" data-level="9.3.2" data-path="results.html"><a href="results.html#viewing-trees"><i class="fa fa-check"></i><b>9.3.2</b> Viewing trees</a></li>
<li class="chapter" data-level="9.3.3" data-path="results.html"><a href="results.html#tree-for-all-data-using-output-of-individual-hybpiper-runs"><i class="fa fa-check"></i><b>9.3.3</b> Tree for all data using output of individual hybpiper runs</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="results.html"><a href="results.html#species-tree-analyses"><i class="fa fa-check"></i><b>9.4</b> Species tree analyses</a></li>
<li class="chapter" data-level="9.5" data-path="results.html"><a href="results.html#support-for-relationships"><i class="fa fa-check"></i><b>9.5</b> Support for relationships</a></li>
<li class="chapter" data-level="9.6" data-path="results.html"><a href="results.html#mrbayes"><i class="fa fa-check"></i><b>9.6</b> MrBayes</a></li>
<li class="chapter" data-level="9.7" data-path="results.html"><a href="results.html#what-do-your-trees-tell-you"><i class="fa fa-check"></i><b>9.7</b> What do your trees tell you?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dates-and-evolution.html"><a href="dates-and-evolution.html"><i class="fa fa-check"></i><b>10</b> Dates and Evolution</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dates-and-evolution.html"><a href="dates-and-evolution.html#dates-times-on-trees"><i class="fa fa-check"></i><b>10.1</b> Dates / Times on Trees</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html"><i class="fa fa-check"></i><b>11</b> Understanding the likelihood function</a>
<ul>
<li class="chapter" data-level="11.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#background-1"><i class="fa fa-check"></i><b>11.1</b> Background</a></li>
<li class="chapter" data-level="11.2" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-model"><i class="fa fa-check"></i><b>11.2</b> The model</a></li>
<li class="chapter" data-level="11.3" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-likelihood-function"><i class="fa fa-check"></i><b>11.3</b> The likelihood function</a></li>
<li class="chapter" data-level="11.4" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#a-mini-example-with-a-sample-size-of-two"><i class="fa fa-check"></i><b>11.4</b> A mini example with a sample size of two</a></li>
<li class="chapter" data-level="11.5" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#the-bird-alarm-example"><i class="fa fa-check"></i><b>11.5</b> The bird alarm example</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#calculate-the-mle-for-dl-and-f-and-the-likelihood-value-evaluated-at-the-mle"><i class="fa fa-check"></i><b>11.5.1</b> Calculate the MLE for DL and F and the likelihood value evaluated at the MLE</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#where-is-the-evidence-for-different-behavior"><i class="fa fa-check"></i><b>11.6</b> Where is the evidence for different behavior?</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#plot-the-likelihood-for-dead-leaf-gleaners"><i class="fa fa-check"></i><b>11.6.1</b> Plot the likelihood for dead-leaf gleaners</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="understanding-the-likelihood-function.html"><a href="understanding-the-likelihood-function.html#are-the-freezing-times-different-for-the-two-groups"><i class="fa fa-check"></i><b>11.7</b> Are the freezing times different for the two groups?</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html"><i class="fa fa-check"></i><b>12</b> What is Bayesian statistics?</a>
<ul>
<li class="chapter" data-level="12.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#what-about-all-the-fighting-of-frequentists-vs.-bayesians"><i class="fa fa-check"></i><b>12.1</b> What about all the fighting of “frequentists” vs. “Bayesians”</a></li>
<li class="chapter" data-level="12.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#when-do-we-choose-bayesian-statistics"><i class="fa fa-check"></i><b>12.2</b> When do we choose Bayesian statistics?</a></li>
<li class="chapter" data-level="12.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#basic-concepts-of-bayesian-statistics"><i class="fa fa-check"></i><b>12.3</b> Basic concepts of Bayesian Statistics</a></li>
<li class="chapter" data-level="12.4" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#example-online-dating"><i class="fa fa-check"></i><b>12.4</b> Example: Online dating</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#pab-is-difficult-to-estimate"><i class="fa fa-check"></i><b>12.4.1</b> <span class="math inline">\(P(A|B)\)</span> is difficult to estimate</a></li>
<li class="chapter" data-level="12.4.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#coming-back-to-the-initial-idea-of-how-we-define-bayesian-statistics"><i class="fa fa-check"></i><b>12.4.2</b> Coming back to the initial idea of how we define Bayesian statistics</a></li>
<li class="chapter" data-level="12.4.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-random-variable"><i class="fa fa-check"></i><b>12.4.3</b> The random variable</a></li>
<li class="chapter" data-level="12.4.4" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-prior-distribution"><i class="fa fa-check"></i><b>12.4.4</b> The prior distribution</a></li>
<li class="chapter" data-level="12.4.5" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-data-and-their-distribution"><i class="fa fa-check"></i><b>12.4.5</b> The Data and their distribution</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-likelihood-function-1"><i class="fa fa-check"></i><b>12.5</b> The likelihood function</a></li>
<li class="chapter" data-level="12.6" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-update-the-posterior-distribution"><i class="fa fa-check"></i><b>12.6</b> The update! The posterior distribution</a></li>
<li class="chapter" data-level="12.7" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#optional-section-doing-your-first-mcmc"><i class="fa fa-check"></i><b>12.7</b> Optional section: Doing your first MCMC</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-proposal-function"><i class="fa fa-check"></i><b>12.7.1</b> The proposal function</a></li>
<li class="chapter" data-level="12.7.2" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#the-metropolis-hastings"><i class="fa fa-check"></i><b>12.7.2</b> The Metropolis-Hastings</a></li>
<li class="chapter" data-level="12.7.3" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#visualizing-the-mcmc-as-a-way-to-find-out-convergence"><i class="fa fa-check"></i><b>12.7.3</b> Visualizing the MCMC as a way to find out convergence</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="what-is-bayesian-statistics.html"><a href="what-is-bayesian-statistics.html#changing-the-proposal"><i class="fa fa-check"></i><b>12.8</b> Changing the proposal</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html"><i class="fa fa-check"></i><b>13</b> Introduction to macroevolution modeling</a>
<ul>
<li class="chapter" data-level="13.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#reading-dataset-and-phylogenetic-tree"><i class="fa fa-check"></i><b>13.1</b> Reading dataset and phylogenetic tree</a></li>
<li class="chapter" data-level="13.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-a-phylogenetic-tree-with-data"><i class="fa fa-check"></i><b>13.2</b> Plotting a phylogenetic tree with data</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-continuous-data"><i class="fa fa-check"></i><b>13.2.1</b> Plotting continuous data</a></li>
<li class="chapter" data-level="13.2.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#plotting-discrete-and-continuous-data"><i class="fa fa-check"></i><b>13.2.2</b> Plotting discrete and continuous data</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#introduction-to-brownian-motion"><i class="fa fa-check"></i><b>13.3</b> Introduction to Brownian Motion</a></li>
<li class="chapter" data-level="13.4" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#brownian-motion-in-phylogenetic-comparative-methods"><i class="fa fa-check"></i><b>13.4</b> Brownian motion in phylogenetic comparative methods</a></li>
<li class="chapter" data-level="13.5" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#shared-ancestry-and-continuous-character-evolution"><i class="fa fa-check"></i><b>13.5</b> Shared ancestry and continuous character evolution</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#always-visualize-your-data"><i class="fa fa-check"></i><b>13.5.1</b> Always visualize your data</a></li>
<li class="chapter" data-level="13.5.2" data-path="introduction-to-macroevolution-modeling.html"><a href="introduction-to-macroevolution-modeling.html#fitting-bm-on-flower-length"><i class="fa fa-check"></i><b>13.5.2</b> Fitting BM on flower length</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html"><i class="fa fa-check"></i><b>14</b> Phylogenetic Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#phylogenetic-linear-models"><i class="fa fa-check"></i><b>14.1</b> Phylogenetic Linear Models</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#testing-the-hypothesis"><i class="fa fa-check"></i><b>14.1.1</b> Testing the hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="phylogenetic-generalized-linear-models.html"><a href="phylogenetic-generalized-linear-models.html#what-happens-if-the-model-of-evolution-is-not-brownian-motion-but-something-else"><i class="fa fa-check"></i><b>14.2</b> What happens if the model of evolution is not Brownian motion but something else?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html"><i class="fa fa-check"></i><b>15</b> Discrete variable modeling</a>
<ul>
<li class="chapter" data-level="15.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#plotting-discrete-data-on-a-phylogeny"><i class="fa fa-check"></i><b>15.1</b> Plotting discrete data on a phylogeny</a></li>
<li class="chapter" data-level="15.2" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#discrete-character-evolution"><i class="fa fa-check"></i><b>15.2</b> Discrete character evolution</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#what-is-a-q-matrix"><i class="fa fa-check"></i><b>15.2.1</b> What is a Q-matrix?</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#modeling-using-ctmcs"><i class="fa fa-check"></i><b>15.3</b> Modeling using CTMCs</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#modeling-the-transition-rates-between-two-states"><i class="fa fa-check"></i><b>15.3.1</b> Modeling the transition rates between two states</a></li>
<li class="chapter" data-level="15.3.2" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#model-comparison"><i class="fa fa-check"></i><b>15.3.2</b> Model comparison</a></li>
<li class="chapter" data-level="15.3.3" data-path="discrete-variable-modeling.html"><a href="discrete-variable-modeling.html#stochastic-mapping"><i class="fa fa-check"></i><b>15.3.3</b> Stochastic mapping</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Andes Phylogenomics Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trait-data" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Trait Data<a href="trait-data.html#trait-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The high-performance computer we’ll use for our data doesn’t have the graphical interface
you usually use (like a PC or Mac).
That means you have to type in your commands - you can’t point and click.
This actually has a hidden benefit because it’s easy to write down what you did in
a line of text rather than having to try to explain where to click on each step.</p>
<div id="getting-started-with-r" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Getting started with R<a href="trait-data.html#getting-started-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="option-1-log-in-to-the-server" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Option 1: Log in to the server<a href="trait-data.html#option-1-log-in-to-the-server" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this duration of this workshop you will have access to a server at the University of Rhode Island. Go to <code>rstudio.uri.edu</code> and log in with the first part of your email address as both the username and password.</p>
</div>
<div id="option-2-work-on-your-personal-computer" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Option 2: Work on your personal computer<a href="trait-data.html#option-2-work-on-your-personal-computer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Follow the instructions to obtain R and RStudio</li>
</ul>
<p><a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></p>
</div>
</div>
<div id="load-and-set-up-data" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Load and set up data<a href="trait-data.html#load-and-set-up-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will be using a dataset to practice that will look a lot like the data you plan to collect.
By the end of this workshop you should be able to examine your own data in a similar way.
Our practice dataset comes from Onstein et al. 2019, which you can find at <a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.13552" class="uri">https://onlinelibrary.wiley.com/doi/10.1111/jbi.13552</a>.
We have uploaded this paper to the server you are working on and we will show you how to access it there shortly. Or if you are unable to access the server, ask your instructor.</p>
<p>Let’s start by getting organized.
We will use both R code and bash/shell scripts in this workshop.
Because RStudio provides a mechanism for setting up projects we will use this to stay organized.
In the RStudio File menu select New Project - New Directory - New Project.</p>
<ul>
<li>Give the project a name (e.g. evolution_workshop). For this and all future work ensure that names never include spaces.</li>
<li>Select R 4.1.2 if you are on the server, as the server has different versions</li>
<li>Create Project</li>
</ul>
<p>By creating a new project you have created a folder for your work.
When using projects whenever you come back to this project you will return to the same setup.
This allows you to switch projects with different folders and open files.</p>
</div>
<div id="beginning-an-analysis" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Beginning an analysis<a href="trait-data.html#beginning-an-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Begin your work by making a script.
This is where you will keep track of all of your analytical commands.
From the File menu select New File - R script.</p>
<p>To analyze data in <code>R</code> we need to load some helper “libraries”. A common library for analysis is the <code>tidyverse</code>, which wraps multiple libraries made by RStudio. For details and cheatsheets see <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a> . We will also use a library that allows us to read Excel files.</p>
<p><strong>If you are using R on your personal computer you will need to install these libraries first.</strong>
Put the following in your script then click the Run icon. <strong>Do not do this if you are using the server</strong></p>
<pre><code>install.packages(readxl)
install.packages(tidyverse)</code></pre>
<p>Put the following in your script then click the Run icon.</p>
<pre><code>library(readxl)
library(tidyverse)</code></pre>
<p>Now we will write a command to read the Excel file with the data from the paper.
The command we use is <code>read_xlsx</code>.
This command takes two arguments in parentheses.
The first is the “path” to the data.
We will discuss paths more extensively later.
For now use the provided argument.
The second argument is the Excel sheet or tab we want to read.
Additionally, when we read the file into memory we assign the information to a “variable”.
You can think of the variable as a box to contain the information.</p>
<pre><code>onstein &lt;- read_xlsx(&#39;../../shared/AndesWorkshop2023/Onstein_data.xlsx&#39;,
                     sheet = &#39;Matrix for analysis&#39;)</code></pre>
<p><strong>If you are not using the server, download the data <a href="https://onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1111%2Fjbi.13552&amp;file=jbi13552-sup-0001-AppendixS1.xlsx">here</a>.</strong> Make sure to save it in your project folder. Your R command will look slightly different because the “address” of the data is different. Try the following or ask your instructor to help you find the path to your file if it is not in your project folder.</p>
<pre><code>onstein &lt;- read_xlsx(&#39;Onstein_data.xlsx&#39;,
                     sheet = &#39;Matrix for analysis&#39;)</code></pre>
<p>When you run this command you will see the data saved in the environment.
When you click on the variable in the environment you will be able to view the data in tabular format.</p>
<p>Before we can do anything with the data, we need to make sure that the computer understands
the data the way we expect.
Click on the arrow next to the variable name in the environment.
Note that all of the columns of data are listed as “chr”.
This means that the information is viewed as characters.
Some of our data is actually numeric and we must convert it in order to analyze it correctly.</p>
<p>To view the column names we use the <code>colnames</code> command and provide the dataset as the argument.</p>
<p>The same column names you see at the top of your dataset when you view it should now appear below on the Console.</p>
<p>We access and work with a single column by specifying the dataset name, followed by a <code>$</code> followed by the column name. For example:</p>
<pre><code>onstein$Log_Fruit_length_avg</code></pre>
<p>We assign a “corrected” version of the data (i.e. one that the computer will interpret as numeric) to this variable. We use the function <code>as.numeric</code> and provide the column of data as the argument. We then assign the output of this command to this same column in this same dataset and it will overwrite the existing information.</p>
<pre><code>onstein$Log_Fruit_length_avg &lt;- as.numeric(onstein$Log_Fruit_length_avg)</code></pre>
<p>Repeat this analysis to ensure that all columns match your expectations.</p>
</div>
<div id="data-visualization" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Data Visualization<a href="trait-data.html#data-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we can visualize the data.
We use the command <code>ggplot</code> and provide the data and the independent and dependent variables we expect on the graph.
For example, we can examine the relationship between seed length and width.</p>
<pre><code>ggplot(onstein, aes(Log_Seed_width_avg, Log_Seed_length_avg))</code></pre>
<p>Note that the variables are provided in an extra function <code>aes</code>.</p>
<p>If you run this command it will generate an empty plot. To plot the points you have to “add” a “layer” on this base of the plot style. In this case we use the <code>geom_point</code> function to add the data as a scatter plot.</p>
<pre><code>ggplot(onstein, aes(Log_Seed_width_avg, Log_Seed_length_avg)) + geom_point()</code></pre>
<p>Do you notice an apparent relationship between these variables?
We can view this more clearly by <em>adding</em> a regression line to our plot.</p>
<pre><code>geom_smooth(method = &quot;lm&quot;, se = FALSE)</code></pre>
<p>For improved viewing we have provided the method argument that specifies a linear model and we opt not to plot the error around the regression line.</p>
<p>The paper from which these data are drawn found “syndromes” in frugivory-related traits
such that fruits and seeds with dispersal by particular mechanisms (e.g. mammals, birds, and bats) have common trait values.
Thus, we can see relationships among traits as above.
The paper describes:</p>
<ul>
<li>“mammal syndromes of few, syncarpous fruits with many seeds, large fruits, and large seeds”</li>
<li>“bird syndromes of many, bright-coloured, small fruits with few, small seeds and long stipes”</li>
<li>“bird syndromes of dehiscent fruits with small seeds”</li>
<li>“bat syndromes of dull-coloured, cauliflorous fruits”</li>
</ul>
<p>Try plotting some relationship on your own. To get you started, you can plot <code>Log_Fruit_length_avg</code> v <code>Log_Seed_number_avg</code> and <code>Log_Fruit_length_avg</code> v. <code>Log_Seed_length_avg</code>. Try others as well.</p>
<p>If you tried plotting with a character variable on the x axis you might find the results difficult to look at.
You can try using a boxplot with <code>geom_boxplot()</code> or other plot type instead.
Check out the ggplot cheatsheet for ideas: <a href="https://posit.co/resources/cheatsheets/?type=posit-cheatsheets&amp;_page=2/" class="uri">https://posit.co/resources/cheatsheets/?type=posit-cheatsheets&amp;_page=2/</a></p>
<p><strong>Stop here and consult with members of your group and other groups. If possible share observed relationships using slides with the entire class.</strong></p>
</div>
<div id="statistical-tests-of-relationships" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Statistical tests of relationships<a href="trait-data.html#statistical-tests-of-relationships" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you have several interesting relationships it’s advisable to confirm that the relationship is statistically significant.
We can examine relationships with a linear model using the <code>lm</code> function.
For example:</p>
<pre><code>lm(Log_Seed_length_avg ~ Log_Seed_width_avg, data = onstein)</code></pre>
<p>Note that the format of the arguments is slightly different than in a <code>ggplot</code>.
The <code>lm</code> function asks you to think in the format “y as a function of x”.</p>
<p>The output of this function does not provide information without additional work.
Assign the output to a new variable. Make sure that your new variable names are informative so that you can keep track of multiple model outputs.</p>
<p>Then provide this variable as the argument to the <code>summary</code> command.</p>
<ul>
<li>Examine the p and r-squared value.</li>
<li>Do these match your observation from the graph?</li>
<li>What conclusions do you draw?</li>
<li>Repeat this process for your other graphs. Make sure you understand the biological interpretation of your results. Discuss with you instructor as needed.</li>
</ul>
<p><strong>Stop here and consult with members of your group and other groups. If possible share observed relationships using slides with the entire class.</strong></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-and-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="computational-skills.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-traitsR.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
